window.__require=function t(e,i,n){function o(c,a){if(!i[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var u=i[c]={exports:{}};e[c][0].call(u.exports,function(t){return o(e[c][1][t]||t)},u,u.exports,t,e,i,n)}return i[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)o(n[c]);return o}({"327_5_DialogCom":[function(t,e,i){"use strict";cc._RF.push(e,"9f53fZEw6NNhLc5x/j+MgBJ","327_5_DialogCom");var n=__extends,o=__decorate;Object.defineProperty(i,"__esModule",{value:!0});var r=t("327_5_DialogSys"),c=cc._decorator,a=c.ccclass,s=c.property;c.inspector;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=0,e.text=null,e.textStr="",e.showTime=.1,e.stayTime=.2,e.hideTime=.5,e.autoHide=!0,e.state=0,e}return n(e,t),e.prototype.onLoad=function(){cc.director.emit(r.default.EventType.REGISTER_DIALOG_COM,this)},o([s({})],e.prototype,"id",void 0),o([s({type:cc.Label})],e.prototype,"text",void 0),o([s({})],e.prototype,"textStr",void 0),o([s({})],e.prototype,"showTime",void 0),o([s({})],e.prototype,"stayTime",void 0),o([s({})],e.prototype,"hideTime",void 0),o([s({})],e.prototype,"autoHide",void 0),o([a],e)}(cc.Component);i.default=l,cc._RF.pop()},{"327_5_DialogSys":"327_5_DialogSys"}],"327_5_DialogSys":[function(t,e,i){"use strict";cc._RF.push(e,"4f80byCGb5MV7HQDAGPcvWT","327_5_DialogSys");var n,o,r=__extends,c=__decorate;Object.defineProperty(i,"__esModule",{value:!0}),i.DialogComEvent=void 0;var a,s=cc._decorator,l=s.ccclass;s.property,(a=n||(n={}))[a.Show=0]="Show",a[a.Stay=1]="Stay",a[a.Hide=2]="Hide",a[a.Disable=3]="Disable",function(t){t.SHOW_COMPLETE="SHOW_COMPLETE",t.STAY_COMPLETE="STAY_COMPLETE",t.HIDE_COMPLETE="HIDE_COMPLETE"}(o||(o={})),i.DialogComEvent=o;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dialogComs=[],e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){var t=this;cc.director.on(i.EventType.REGISTER_DIALOG_COM,function(e){t._dialogComs.indexOf(e)>=0||(e.state=n.Disable,t._dialogComs.push(e))},this),cc.director.on(i.EventType.SHOW_DIALOG,this.showDialog,this),cc.director.on(i.EventType.SHOW_DIALOG_IMMED,this.showDialogImmed,this),cc.director.on(i.EventType.HIDE_DIALOG,this.hideDialog,this),cc.director.on(i.EventType.HIDE_DIALOG_IMMED,this.hideDialogImmed,this),cc.director.on(i.EventType.HIDE_ALL_DIALOG,this.hideAllDialog,this)},e.prototype.update=function(){var t=this.diaLogComs;if(!(t.length<=0))for(var e=0,i=t;e<i.length;e++){var o=i[e];if(o.state===n.Disable&&o.enabled){var r=o.node;r.stopAllActions(),r.opacity=0,r.active=!1}}},Object.defineProperty(e.prototype,"diaLogComs",{get:function(){return this._dialogComs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curDialogNodes",{get:function(){return this.diaLogComs.filter(function(t){return t.state!==n.Disable}).map(function(t){return t.node})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasShowDialog",{get:function(){return this.curDialogNodes.length>0},enumerable:!1,configurable:!0}),e.prototype.setDialogAttrById=function(t,e){void 0===e&&(e=0);for(var i=0,n=this.diaLogComs;i<n.length;i++){var o=n[i];o.id===e&&Object.assign(o,t)}},e.prototype.showDialog=function(t,e,i){void 0===e&&(e=0);var n=this.diaLogComs.filter(function(t){return t.id===e&&t.enabled});if(0!==n.length)for(var o=function(e){var o=e,c=n[o],a=c.text||c.node.getComponentInChildren(cc.Label);if(!a)return"continue";a.string=c.textStr=t,r._showDialogASM(c).then(function(){o===n.length-1&&i&&i()})},r=this,c=0;c<n.length;c++)o(c)},e.prototype.showDialogImmed=function(t,e,i){void 0===e&&(e=0);var r=this.diaLogComs.filter(function(t){return t.id===e&&t.enabled});if(0!==r.length)for(var c=function(e){var c=e,s=r[c],l=s.text||s.node.getComponentInChildren(cc.Label);if(!l)return"continue";l.string=s.textStr=t;var u=s.node;u.stopAllActions(),u.opacity=255,u.emit(o.SHOW_COMPLETE),s.state=n.Stay,a._showDialogASM(s).then(function(){c===r.length-1&&i&&i()})},a=this,s=0;s<r.length;s++)c(s)},e.prototype.hideDialog=function(t,e){void 0===t&&(t=0);var i=this.diaLogComs.filter(function(e){return e.id===t&&e.enabled});if(0!==i.length)for(var n=function(t){var n=t,r=i[n];o._concealPromptASM(r).then(function(){n===i.length-1&&e&&e()})},o=this,r=0;r<i.length;r++)n(r)},e.prototype.hideDialogImmed=function(t,e){void 0===t&&(t=0);var i=this.diaLogComs.filter(function(e){return e.id===t&&e.enabled});if(0!==i.length)for(var r=function(t){var r=t,a=i[r],s=a.node;s.stopAllActions(),s.opacity=0,s.emit(o.HIDE_COMPLETE),a.state=n.Disable,c._concealPromptASM(a).then(function(){r===i.length-1&&e&&e()}),s.active=!1},c=this,a=0;a<i.length;a++)r(a)},e.prototype.hideAllDialog=function(){var t=this;this.diaLogComs.forEach(function(e){t._concealPromptASM(e)})},e.prototype.hideAllDialogImmed=function(){this.diaLogComs.forEach(function(t){var e=t.node;e.stopAllActions(),e.opacity=0,e.emit(o.HIDE_COMPLETE),t.state=n.Disable})},e.prototype._showDialogASM=function(t){var e=this;return new Promise(function(i){var r=t.node,c=function(){r.emit(o.STAY_COMPLETE),t.autoHide?e._concealPromptASM(t).then(function(){i()}):i()};switch(r.active=!0,t.state){case n.Show:r.once(o.SHOW_COMPLETE,function(){t.state=n.Stay,t[o.STAY_COMPLETE]=c,t.scheduleOnce(c,t.stayTime*t.textStr.length)});break;case n.Stay:t[o.STAY_COMPLETE]&&t.unschedule(t[o.STAY_COMPLETE]),t[o.STAY_COMPLETE]=c,t.scheduleOnce(c,t.stayTime*t.textStr.length);break;case n.Hide:r.stopAllActions(),t.state=n.Show;var a=t.showTime*(1-r.opacity/255)+.05;cc.tween(r).to(a,{opacity:255}).call(function(){r.emit(o.SHOW_COMPLETE)}).start(),i(e._showDialogASM(t));break;case n.Disable:t.state=n.Show,cc.tween(r).to(t.showTime,{opacity:255}).call(function(){r.emit(o.SHOW_COMPLETE)}).start(),i(e._showDialogASM(t))}})},e.prototype._concealPromptASM=function(t){return new Promise(function(e){var i=t.node;switch(t.state){case n.Show:i.stopAllActions(),t.state=n.Hide;var r=t.hideTime*(1-i.opacity/255);cc.tween(i).to(r,{opacity:0}).call(function(){i.emit(o.HIDE_COMPLETE),t.state=n.Disable,e(),i.active=!1}).start();break;case n.Stay:t[o.STAY_COMPLETE]&&(t.unschedule(t[o.STAY_COMPLETE]),t[o.STAY_COMPLETE]=null),t.state=n.Hide,cc.tween(i).to(t.hideTime,{opacity:0}).call(function(){i.emit(o.HIDE_COMPLETE),t.state=n.Disable,e(),i.active=!1}).start();break;case n.Hide:break;case n.Disable:e()}})},e.EventType={SHOW_DIALOG:"SHOW_DIALOG",SHOW_DIALOG_IMMED:"SHOW_DIALOG_IMMED",HIDE_DIALOG:"HIDE_DIALOG",HIDE_DIALOG_IMMED:"HIDE_DIALOG_IMMED",HIDE_ALL_DIALOG:"HIDE_ALL_DIALOG",REGISTER_DIALOG_COM:"REGISTER_DIALOG_COM"},i=c([l],e)}(cc.Component);i.default=u,cc._RF.pop()},{}],"327_5_LevelCtrl":[function(t,e,i){"use strict";cc._RF.push(e,"cb4a1RZUXJNFqjTPiMKjnd8","327_5_LevelCtrl");var n=__extends,o=__decorate,r=__awaiter,c=__generator;Object.defineProperty(i,"__esModule",{value:!0});var a=t("AudioManager"),s=t("327_5_DialogSys"),l=cc._decorator,u=l.ccclass,h=l.property,d=Array.from({length:6},function(){return{q:{str:"\u9009\u5de6\u8fb9\u8fd8\u662f\u9009\u53f3\u8fb9",id:1,a:"327_5_q_1"},a:[{str:"\u9009\u5de6\u8fb9",a:"327_5_a_1"},{str:"\u9009\u53f3\u8fb9",a:"327_5_a_2"}]}}),f={s:[{str:"\u8001\u516c\u6311\u7684\u8863\u670d\uff0c\u56de\u5934\u7387\u597d\u9ad8\u554a",a:"327_5_succ_1"}],f:[{str:"\u8fd9\u88d9\u5b50\u8ddf\u8863\u670d\u4e0d\u662f\u5f88\u642d\u8bf6\uff0c\u901b\u8857\u8d77\u6765\u597d\u5947\u602a",a:"327_5_fail_1"},{str:"\u8fd9\u978b\u5b50\u8ddf\u8863\u670d\u4e0d\u662f\u5f88\u642d\u8bf6\uff0c\u901b\u8857\u8d77\u6765\u597d\u5947\u602a",a:"327_5_fail_2"},{str:"\u8fd9\u4e1d\u889c\u8ddf\u8863\u670d\u4e0d\u662f\u5f88\u642d\u8bf6\uff0c\u901b\u8857\u8d77\u6765\u597d\u5947\u602a",a:"327_5_fail_3"},{str:"\u8fd9\u5934\u53d1\u8ddf\u8863\u670d\u4e0d\u662f\u5f88\u642d\u8bf6\uff0c\u901b\u8857\u8d77\u6765\u597d\u5947\u602a",a:"327_5_fail_4"},{str:"\u8fd9\u5934\u9970\u8ddf\u8863\u670d\u4e0d\u662f\u5f88\u642d\u8bf6\uff0c\u901b\u8857\u8d77\u6765\u597d\u5947\u602a",a:"327_5_fail_5"}]},_=[{str:"\u4eb2\u7231\u7684\uff0c\u901b\u8857\u7684\u8863\u670d\u6211\u5e2e\u4f60\u9009\u597d\u5566\uff0c\u4f60\u9009\u4e00\u4e0b",id:1,a:"327_5_start_1"}],p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBox=null,e.girlFriend=null,e.player=null,e.btn=null,e.endScene=null,e.selectRecord=[],e._curAudio=-1,e}return n(e,t),Object.defineProperty(e.prototype,"curAudio",{get:function(){return this._curAudio},set:function(t){-1!==this._curAudio&&cc.audioEngine.stop(this._curAudio),this._curAudio=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.btn.active=!1,this.itemBox.active=!1,this.endScene.active=!1},e.prototype.start=function(){return r(this,void 0,void 0,function(){var t,e=this;return c(this,function(i){switch(i.label){case 0:t=0,i.label=1;case 1:return t<_.length?[4,this.showDialog(_[t])]:[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:t=0,i.label=5;case 5:return t<d.length?[4,this.showQuestion(t)]:[3,8];case 6:i.sent(),i.label=7;case 7:return t++,[3,5];case 8:return cc.tween(this.itemBox).to(1,{opacity:0}).call(function(){e.end()}).start(),[2]}})})},e.prototype.showQuestion=function(t){return r(this,void 0,void 0,function(){var e=this;return c(this,function(){return[2,new Promise(function(i){return r(e,void 0,void 0,function(){var e,n,o,s=this;return c(this,function(l){switch(l.label){case 0:return e=function(){var e;s.itemBox.active=!1,s.itemBox.children.forEach(function(e,i){e.active=t===i}),s.itemBox.active=!0,null===(e=s.itemBox.getComponent(cc.Animation))||void 0===e||e.play()},n=function(e){return r(s,void 0,void 0,function(){var o,r,s,l,u=this;return c(this,function(c){switch(c.label){case 0:switch(a.default.playEffect(a.default.audioName.BUTTON),o=e.getCurrentTarget().name,this.btn.active=!1,this.btn.children.forEach(function(t){t.off(cc.Node.EventType.TOUCH_END,n,u)}),r=null,s=null,this.player.children.forEach(function(t){t.active=!0}),this.scheduleOnce(function(){u.player.children.forEach(function(t){t.active=!1})},1),o){case"left":r=d[t].a[0],s=this.itemBox.children[t].children[0],this.showSelectAnim("left");break;case"right":r=d[t].a[1],s=this.itemBox.children[t].children[1],this.showSelectAnim("right")}return l=s.name.split("_")[0],this.selectRecord.push("evreya"===l?1:0),[4,this.showDialog(r)];case 1:return c.sent(),this.closeSelectAnim(),this.itemBox.children[t].children.forEach(function(t){t.opacity=255}),[4,this.showNode(s)];case 2:return c.sent(),i(),[2]}})})},this.btn.children.forEach(function(t){t.on(cc.Node.EventType.TOUCH_END,n,s)}),this.btn.active=!0,e(),null===(o=this.btn.getComponent(cc.Animation))||void 0===o||o.play(),[4,this.showDialog(d[t].q)];case 1:return l.sent(),[2]}})})})]})})},e.prototype.showNode=function(t){return r(this,void 0,void 0,function(){var e=this;return c(this,function(){return[2,new Promise(function(i){var n;t.opacity=0;var o=t.name.split("_"),r=e.girlFriend.getChildByName(t.name)||(null===(n=e.girlFriend.getChildByName(o[0]))||void 0===n?void 0:n.getChildByName(o[1]));r&&r.getComponent(cc.Animation)?(r.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){i()},e),r.active=!0,r.getComponent(cc.Animation).play()):i()})]})})},e.prototype.showSelectAnim=function(t){var e,i=!this.girlFriend.getChildByName("evreya").getChildByName("top").active,n=this.girlFriend.getChildByName("evreya").getChildByName("top").getChildByName(t),o=this.girlFriend.getChildByName("hand").getChildByName("normal").getChildByName(t),r=this.girlFriend.getChildByName("hand").getChildByName("select").getChildByName(t+"_s"),c=this.girlFriend.getChildByName("hand").getChildByName("evreya").getChildByName(t+"_s");n.active=!1,o.active=!1;var a=i?r:c;a.active=!0,null===(e=a.getComponent(cc.Animation))||void 0===e||e.play()},e.prototype.closeSelectAnim=function(){var t=this.girlFriend.getChildByName("evreya").getChildByName("top"),e=this.girlFriend.getChildByName("hand").getChildByName("normal"),i=this.girlFriend.getChildByName("hand").getChildByName("select"),n=this.girlFriend.getChildByName("hand").getChildByName("evreya");t.children.forEach(function(t){t.active=!0}),e.children.forEach(function(t){t.active=!0}),i.children.forEach(function(t){t.active=!1}),n.children.forEach(function(t){t.active=!1})},e.prototype.showDialog=function(t){return r(this,void 0,void 0,function(){var e=this;return c(this,function(){return[2,new Promise(function(i){return r(e,void 0,void 0,function(){var e;return c(this,function(n){switch(n.label){case 0:return t.a?(e=this,[4,a.default.playEffect(t.a)]):[3,2];case 1:e.curAudio=n.sent(),n.label=2;case 2:return cc.director.emit(s.default.EventType.SHOW_DIALOG,t.str,t.id,function(){i()}),[2]}})})})]})})},e.prototype.end=function(){return r(this,void 0,void 0,function(){var t,e,i,n,o=this;return c(this,function(){return t=this.endScene.getChildByName("gf"),this.girlFriend.parent=t,this.girlFriend.setPosition(0,0),this.endScene.active=!0,this.endScene.opacity=0,e=this.selectRecord.every(function(t){return t===o.selectRecord[0]}),i=this.selectRecord.findIndex(function(t){return t!==o.selectRecord[0]}),n=e?f.s:f.f,cc.tween(this.endScene).to(.5,{opacity:255}).delay(.5).call(function(){return r(o,void 0,void 0,function(){var t,o=this;return c(this,function(r){switch(r.label){case 0:if(!e)return[3,5];t=0,r.label=1;case 1:return t<n.length?[4,this.showDialog(n[t])]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[3,7];case 5:return[4,this.showDialog(n[i-1])];case 6:r.sent(),r.label=7;case 7:return this.scheduleOnce(function(){e?o.node.getComponent("LevelCtrl_CommonResult").onGameSucc():o.node.getComponent("LevelCtrl_CommonResult").onGameFail()},1),[2]}})})}).start(),[2]})})},o([h(cc.Node)],e.prototype,"itemBox",void 0),o([h(cc.Node)],e.prototype,"girlFriend",void 0),o([h(cc.Node)],e.prototype,"player",void 0),o([h(cc.Node)],e.prototype,"btn",void 0),o([h(cc.Node)],e.prototype,"endScene",void 0),o([u],e)}(cc.Component);i.default=p,cc._RF.pop()},{"327_5_DialogSys":"327_5_DialogSys",AudioManager:void 0}]},{},["327_5_DialogCom","327_5_DialogSys","327_5_LevelCtrl"]);