window.__require=function t(e,a,i){function n(s,c){if(!a[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var d="function"==typeof __require&&__require;if(!c&&d)return d(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var l=a[s]={exports:{}};e[s][0].call(l.exports,function(t){return n(e[s][1][t]||t)},l,l.exports,t,e,a,i)}return a[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({"316_4_Ani":[function(t,e,a){"use strict";cc._RF.push(e,"08e0fvIdxBOg6ZstdM5CIOy","316_4_Ani");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0});var o=t("AudioManager"),s=t("316_AudioConfig"),c=t("316_StateNodeSys"),r=t("316_AudioFunc"),d=t("316_4_Config"),l=cc._decorator,u=l.ccclass;l.property;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateSys=null,e._angryColor=cc.color(255,150,150),e._isUpdateHeart=!0,e.time=0,e}return i(e,t),e.prototype.onLoad=function(){this.stateSys=this.node.getComponent(c.default),this.stateSys.on(c.default.EventType.ENTER_STATE,this._onEnterState,this),this.stateSys.on(c.default.EventType.UPDATE_STATE,this._onUpdateState,this)},e.prototype.start=function(){this.stateSys.setAttrById(1,{state:d.default.length}),this.stateSys.setAttrById(2,{state:d.default.length})},e.prototype._onEnterState=function(t){switch(t){case 1:case 2:this._onHPUpdate(t);break;case 3:case 4:switch(this.stateSys.getAttrById(t)[0].state){case 0:this._roleEnterState0(t);break;case 1:this._roleEnterState1(t);break;case 2:this._roleEnterState2(t);break;case 3:this._roleEnterState3(t)}}},e.prototype._onUpdateState=function(t,e){var a=d.default.length;switch(t){case 1:case 2:if(!this._isUpdateHeart)return;var i=this.stateSys.getAttrById(t)[0],n=60/(20+40*(a-i.state)/a);this.time+=e;var o=this.time%n/n*Math.PI*2,s=1+.05*Math.sin(o);i.node.getChildByName("heart").scale=s;break;case 3:case 4:var c=this.stateSys.getAttrById(t)[0],r=60/(7+(a-this.stateSys.getAttrById(t-2)[0].state)/a*11);this.time+=e;var l=this.time%r/r*Math.PI*2,u=1+.005*Math.sin(l);c.node.scaleY=u}},e.prototype._onHPUpdate=function(t){var e=this.stateSys.getAttrById(t)[0],a=e.state/d.default.length,i=e.node.getChildByName("progress"),n=e.node.getChildByName("bang"),o=e.node.getChildByName("heart");o.getChildByName("num").getComponent(cc.Label).string=0===e.state?"":e.state.toString(),n.active=!1,i.scaleY!==a&&(0===a&&(o.active=!1,n.active=!0,n.getComponent(cc.Animation).play(),r.playCommonEffect_316(s.default.heart)),cc.tween(i).to(.1,{scaleY:a}).start())},e.prototype._roleEnterState0=function(t){var e=this.stateSys.getAttrById(t)[0],a=e.node.getChildByName("idle"),i=e.node.getChildByName("angry"),n=e.node.getChildByName("end"),o=e.node.getChildByName("laugh");switch(a.active=!0,i.active=!1,n.active=!1,o.active=!1,t){case 3:var s=e.node.getChildByName("hand_1"),c=e.node.getChildByName("hand_2"),r=i.getChildByName("slap_effect_1");s.active=!1,c.active=!1,r.active=!1;break;case 4:e.node.getChildByName("angry_effect").active=!1,e.node.getChildByName("dust").active=!1}},e.prototype._roleEnterState1=function(t){var e=this,a=this.stateSys.getAttrById(t)[0],i=a.node.getChildByName("idle"),n=a.node.getChildByName("angry");switch(t){case 3:i.active=!1,n.active=!0;var o=a.node.getChildByName("hand_1"),c=n.getChildByName("slap_effect_1"),d=a.node.getChildByName("blush");o.angle=-50,o.active=!0;var l=!1;cc.tween(o).to(.2,{angle:50},{easing:cc.easing.backOut,progress:function(t,e,a,i){return a>0&&!l&&(l=!0,r.playCommonEffect_316(s.default.slap),c.opacity=255,c.active=!0,cc.tween(c).to(.1,{opacity:0}).call(function(){c.active=!1}).start()),t+(e-t)*i}}).set({angle:-50}).call(function(){l=!1}).union().repeat(2).call(function(){o.angle=50,d.opacity=0,d.active=!0,cc.tween(d).to(.2,{opacity:255}).delay(.5).call(function(){e.stateSys.setAttrById(3,{state:0})}).to(1.5,{opacity:0}).start()}).start();break;case 4:var u=a.node.getChildByName("angry_effect");i.active=!1,n.active=!0,cc.tween(n).to(.1,{scale:1.1,color:this._angryColor}).call(function(){u.active=!0,u.getComponent(cc.Animation).play(),r.playCommonEffect_316(s.default.jet)}).delay(1).to(.5,{color:cc.Color.WHITE,scale:1}).delay(.5).call(function(){e.stateSys.setAttrById(4,{state:0})}).start()}},e.prototype._roleEnterState2=function(t){var e=this,a=this.stateSys.getAttrById(t)[0],i=a.node.getChildByName("idle"),n=a.node.getChildByName("angry"),o=a.node.getChildByName("end");switch(i.active=!1,t){case 3:n.active=!1,o.active=!0;var c=a.node.getChildByName("hand_2"),d=c.getChildByName("echo_effect");c.angle=60,d.active=!1,c.active=!0,cc.tween(c).to(.2,{angle:0},{easing:cc.easing.backOut,progress:function(t,e,a,i){return a>0&&!d.active&&(r.playCommonEffect_316(s.default.hammer),d.active=!0),t+(e-t)*i}}).start();break;case 4:var l=a.node.getChildByName("angry_effect"),u=a.node.getChildByName("dust"),h=o.getChildByName("eye_open"),f=o.getChildByName("eye_close");n.active=!0,cc.tween(n).to(.1,{scale:1.1}).call(function(){o.active=!0,h.active=!0,f.active=!1,r.playCommonEffect_316(s.default.smokeS),cc.tween(o).set({scale:1.1,color:cc.Color.BLACK}).to(.1,{scale:1,color:cc.Color.WHITE}).call(function(){u.active=!0,e.schedule(function(){e.schedule(function(){h.active=!h.active,f.active=!f.active},.2,3)},3)}).start(),l.active=!1,n.active=!1}).start()}},e.prototype._roleEnterState3=function(t){var e=this,a=this.stateSys.getAttrById(t)[0],i=a.node.getChildByName("idle"),n=a.node.getChildByName("laugh");i.active=!1,n.active=!0,o.default.playEffect(s.default[4]["role_"+(t-2)+"_laugh"]),this.scheduleOnce(function(){e.stateSys.setAttrById(t,{state:0})},2)},e.prototype.onHeartCollision=function(t){var e=this,a=this.stateSys.getAttrById(1)[0],i=this.stateSys.getAttrById(2)[0],n=a.node.getChildByName("heart"),o=i.node.getChildByName("heart"),s=function(t){var e=cc.instantiate(t);return e.parent=t.parent,e.position=cc.v3(0,0),e.scale=1,e.active=!0,e.getChildByName("num").active=!1,e},c=a.node.getChildByName("bang"),r=i.node.getChildByName("bang"),d=a.node.parent.convertToWorldSpaceAR(cc.v2(0,a.node.y)),l=function(t,e){void 0===e&&(e=null),cc.tween(t).to(.1,{scale:1.5}).to(.5,{position:cc.v3(t.parent.convertToNodeSpaceAR(d)),scale:2}).call(function(){e&&e()}).start()},u=s(n),h=s(o),f=function(){c.active=!1,r.active=!1,cc.tween(o).to(o.position.mag()/500,{position:cc.v3(0,0),scale:1}).call(function(){o.active&&h.destroy(),e._isUpdateHeart=!0}).start(),cc.tween(n).to(n.position.mag()/500,{position:cc.v3(0,0),scale:1}).call(function(){n.active&&u.destroy(),e._isUpdateHeart=!0}).start()};this._isUpdateHeart=!1,l(n),l(o),l(c),l(r,function(){c.active=!0,r.active=!0,t&&t(),c.getComponent(cc.Animation).on("finished",function(){f()},e),r.getComponent(cc.Animation).on("finished",function(){f()},e)})},n([u],e)}(cc.Component);a.default=h,cc._RF.pop()},{"316_4_Config":"316_4_Config","316_AudioConfig":void 0,"316_AudioFunc":void 0,"316_StateNodeSys":void 0,AudioManager:void 0}],"316_4_Config":[function(t,e,a){"use strict";cc._RF.push(e,"822f8Jb+B9BpJutBTYW8cwF","316_4_Config"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=[{question:"\u6751\u6709\u4e2a\u5c0f\u4f19\u4eca\u5e7430\uff0c\u4eba\u53ef\u597d\u4e86",answer:["\u90a3\u4e48\u597d\uff0c\u4f60\u548c\u4ed6\u5904\u8fc7\u554a","\u4eba\u597d\u6211\u4e5f\u8981\u8003\u8651\u4e00\u4e0b","\u4ed6\u597d\u4e0d\u597d\uff0c\u4f60\u8bf4\u4e86\u7b97\u554a\uff1f"],answerIdx:0,sort:[1,2,3]},{question:"\u5230\u4e86\u5e74\u9f84\u5c31\u8be5\u65e9\u70b9\u7ed3\u5a5a\uff0c\u665a\u4e86\u5c31\u5ac1\u4e0d\u51fa\u53bb\u4e86",answer:["\u90a3\u5230\u4e86\u5e73\u5747\u5bff\u547d\uff0c\u662f\u4e0d\u662f\u8fd8\u5f97\u539f\u5730\u53bb\u4e16\u554a","\u963f\u59e8\u6211\u77e5\u9053\u4f60\u5f88\u6025\uff0c\u4f46\u4f60\u5148\u522b\u6025","\u9047\u5230\u5408\u9002\u7684\u4eba\uff0c\u6211\u624d\u8003\u8651"],answerIdx:0,sort:[3,1,2]},{question:"\u4f60\u8fd9\u5b69\u5b50\u600e\u4e48\u4e0d\u613f\u610f\u8bf4\u8bdd\u5440\uff1f",answer:["\u4f60\u8fd9\u957f\u8f88\u600e\u4e48\u4e0d\u613f\u610f\u53d1\u7ea2\u5305\u554a","\u6211\u4eba\u6bd4\u8f83\u5185\u5411\u4e0d\u7231\u8bf4\u8bdd","\u4e0d\u60f3\u6210\u4e3a\u4f60\u8fd9\u6837\u559c\u6b22\u53e8\u53e8\u53e8\u7684\u4eba"],answerIdx:0,sort:[1,3,2]},{question:"\u4f60\u4e0d\u7ed3\u5a5a\u751f\u5c0f\u5b69\uff0c\u8c01\u7ed9\u4f60\u517b\u8001\u9001\u7ec8\u554a\uff1f",answer:["\u513f\u5b59\u81ea\u6709\u513f\u5b59\u798f\uff0c\u4e0d\u751f\u513f\u5b59\u6211\u4eab\u798f","\u6211\u4e00\u4e2a\u4eba\u8fc7\u4e5f\u633a\u597d\u7684","\u751f\u5c0f\u5b69\u540e\u81ea\u5df1\u5c31\u6ca1\u65f6\u95f4\u4e86"],answerIdx:0,sort:[2,3,1]},{question:"\u8003\u4e0a\u5927\u5b66\u6709\u5565\u7528\uff0c\u4e0d\u8fd8\u5f97\u7ed9\u522b\u4eba\u6253\u5de5",answer:["\u8001\u5f1f\u5feb\u8ddf\u6211\u6253\u6e38\u620f\uff0c\u4f60\u5988\u8bf4\u8003\u5927\u5b66\u6ca1\u7528","\u591a\u8bfb\u70b9\u4e66\uff0c\u624d\u80fd\u79bb\u4f60\u8fd9\u79cd\u4eba\u8fdc\u4e00\u70b9","\u73b0\u5728\u5de5\u4f5c\uff0c\u80fd\u7cca\u53e3\u996d\u5403\u5c31\u884c"],answerIdx:0,sort:[3,2,1]},{question:"\u6210\u5929\u5c31\u77e5\u9053\u770b\u624b\u673a\uff0c\u4f60\u8fd9\u6837\u773c\u775b\u8fdf\u65e9\u8981\u778e",answer:["\u6ca1\u529e\u6cd5\uff0c\u624b\u673a\u6bd4\u4f60\u597d\u770b\u554a","\u4e0d\u8981\u4e00\u5929\u5230\u665a\u54d4\u54d4\u53e8\u53e8\u7684\u53eb","\u6211\u5e73\u65f6\u6bd4\u8f83\u5c11\u73a9\u624b\u673a\u7684"],answerIdx:0,sort:[1,3,2]},{question:"\u5ac1\u4eba\u4e4b\u540e\uff0c\u53ef\u4e0d\u80fd\u8fd9\u6837\u8ddf\u516c\u5a46\u9876\u5634",answer:["\u6211\u77e5\u9053\u4e86\uff0c\u76f4\u63a5\u52a8\u624b\u662f\u5417","\u6211\u73b0\u5728\u8fd8\u4e0d\u60f3\u5ac1\u4eba","\u4f60\u4ee5\u524d\u4e0d\u4e5f\u7ecf\u5e38\u8ddf\u516c\u5a46\u62cc\u5634"],answerIdx:0,sort:[2,3,1]}],cc._RF.pop()},{}],"316_4_LevelCtrl":[function(t,e,a){"use strict";cc._RF.push(e,"92071exDhVIHbxa8qqLHfN/","316_4_LevelCtrl");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0});var o=t("LevelCtrl_CommonResult"),s=t("TapLayer"),c=t("AssetManager"),r=t("AudioManager"),d=t("316_AudioConfig"),l=t("316_TextConfig"),u=t("316_AnswerSys"),h=t("316_DialogSys"),f=t("316_StateNodeSys"),y=t("316_AudioFunc"),_=t("316_4_Ani"),g=t("316_4_Config"),p=cc._decorator,v=p.ccclass,C=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.question=null,e.state=null,e.dialog=null,e.ani=null,e.guide=null,e._curQIdx=-1,e._isInit=!1,e._isRight=!1,e._isGuide=!1,e}return i(e,t),e.prototype.onLoad=function(){this.question.on(u.default.EventType.SHOW_ANSWER,this._onShowAnswer,this),this.question.on(u.default.EventType.CLICK_ANSWER,this._onClickedAnswer,this),this.state.on(f.default.EventType.ENTER_STATE,this._onEnterState,this),this.guide.active=!1},e.prototype.start=function(){this.dialog.hideAllDialogImmed()},e.prototype._onEnterState=function(t){var e=this;switch(t){case 3:case 4:if(this._isInit=this.state.getAttrById(3)[0].isFind&&this.state.getAttrById(4)[0].isFind||this._isInit,0===this.state.getAttrById(3)[0].state&&0===this.state.getAttrById(4)[0].state&&this._isInit)if(this._curQIdx<g.default.length-1)this.showQuestion(this._curQIdx+1);else{var a=this.state.getAttrById(1)[0],i=this.state.getAttrById(2)[0],n=function(){var t=!1;a.state<i.state?(e.state.setAttrById(1,{state:0}),e.state.setAttrById(3,{state:2})):(t=!0,e.state.setAttrById(2,{state:0}),e.state.setAttrById(4,{state:2})),e.scheduleOnce(function(){(t?e._onGameWin:e._onGameFail).call(e)},t?5:2)};0!==a.state&&0!==i.state?this.ani.onHeartCollision(n):n()}}},e.prototype.showQuestion=function(t){var e=this;this._curQIdx=t;var a=g.default[t];c.default.loadSoundEffect_fileDir("AudioClip/lv_316/4",function(){r.default.playEffect(d.default[4]["sten_"+(t+1)])}),this.dialog.showDialog(a.question).then(function(){e.question.show({quest:a.question,answer:a.answer})})},e.prototype._onShowAnswer=function(t,e){var a=t.getChildByName("lbl").getComponent(cc.Label),i=g.default[this._curQIdx].sort,n=g.default[this._curQIdx].answer.indexOf(e);t.zIndex=i[n],a.string=e,this._isGuide||(this._isGuide=!0,this.guide.active=!0)},e.prototype._onClickedAnswer=function(t,e){var a=this;this.guide.active=!1,s.default.Ins.showTap(e.getLocation()),this.question.hide();var i=g.default[this._curQIdx],n=i.answer[t];this._isRight=t===i.answerIdx,y.playCommonEffect_316(this._isRight?d.default.successS:d.default.wrongS),this.dialog.hideDialog(0),r.default.playEffect(d.default[4]["sten_"+(this._curQIdx+1)+"_"+(t+1)]),this.dialog.showDialog(n,1).then(function(){a._curQIdx<=g.default.length-1&&(a._isRight?(a.state.setAttrById(2,{state:a.state.getAttrById(2)[0].state-1}),a.state.setAttrById(4,{state:1}),a.state.setAttrById(3,{state:3})):(a.state.setAttrById(1,{state:a.state.getAttrById(1)[0].state-1}),a.state.setAttrById(3,{state:1}),a.state.setAttrById(4,{state:3})))})},e.prototype._onGameWin=function(){var t=this;r.default.playEffect(d.default[4].role_2_end),this.dialog.setDialogAttrById({autoHide:!0},0),this.dialog.showDialog(l.default[4].role_2_end).then(function(){t.node.getComponent(o.default).onGameSucc()})},e.prototype._onGameFail=function(){var t=this;r.default.playEffect(d.default[4].role_1_end),this.dialog.showDialog(l.default[4].role_1_end,1).then(function(){t.node.getComponent(o.default).onGameFail()})},e.prototype.showClickWave=function(){s.default.Ins.showTap(this.guide.convertToWorldSpaceAR(cc.v2(0,0)))},n([C({type:u.default})],e.prototype,"question",void 0),n([C({type:f.default})],e.prototype,"state",void 0),n([C({type:h.default})],e.prototype,"dialog",void 0),n([C({type:_.default})],e.prototype,"ani",void 0),n([C({type:cc.Node})],e.prototype,"guide",void 0),n([v],e)}(cc.Component);a.default=m,cc._RF.pop()},{"316_4_Ani":"316_4_Ani","316_4_Config":"316_4_Config","316_AnswerSys":void 0,"316_AudioConfig":void 0,"316_AudioFunc":void 0,"316_DialogSys":void 0,"316_StateNodeSys":void 0,"316_TextConfig":void 0,AssetManager:void 0,AudioManager:void 0,LevelCtrl_CommonResult:void 0,TapLayer:void 0}]},{},["316_4_Ani","316_4_Config","316_4_LevelCtrl"]);