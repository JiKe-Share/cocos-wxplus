window.__require=function t(i,c,e){function o(s,a){if(!c[s]){if(!i[s]){var l=s.split("/");if(l=l[l.length-1],!i[l]){var h="function"==typeof __require&&__require;if(!a&&h)return h(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var r=c[s]={exports:{}};i[s][0].call(r.exports,function(t){return o(i[s][1][t]||t)},r,r.exports,t,i,c,e)}return c[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<e.length;s++)o(e[s]);return o}({lv501_23_Ctrl:[function(t,i,c){"use strict";cc._RF.push(i,"3f452BmNiZBkJ2joKYBaBEi","lv501_23_Ctrl");var e=__extends,o=__decorate;Object.defineProperty(c,"__esModule",{value:!0});var n=t("MathTool"),s=t("LevelCtrl_CommonResult"),a=t("AudioManager"),l=cc._decorator,h=l.ccclass,r=l.property,u=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.tasklist=null,i.titlelist=[],i.dd=null,i.scc=null,i.successnum=9,i.localnum=0,i.plan=0,i.cleanpos=[],i.cleamposnum=0,i.progressBar=null,i.node_splash=null,i.node_ef_stars=null,i.isworking=!1,i.isover=!1,i.isplay=!1,i}return e(i,t),i.prototype.onLoad=function(){var t=this;this.scc=this.node.getChildByName("scc"),this.title=this.node.getChildByName("title"),this.progressBar=this.node.getChildByName("progressBar").getComponent(cc.ProgressBar),this.node_ef_stars=this.node.getChildByName("ef_stars"),this.node_splash=this.node.getChildByName("splash"),this.scc.active=!1,this.UpNode(),cc.sys.isBrowser&&cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(i){i.keyCode==cc.macro.KEY.space&&(t.plan++,t.UpNode())},this)},i.prototype.UpNode=function(){for(var t=0;t<this.tasklist.childrenCount;t++)t==this.plan?this.tasklist.children[t].active=!0:this.tasklist.children[t].active=!1;switch(this.title.getComponent(cc.Label).string=this.titlelist[this.plan],this.toolNode=this.tasklist.children[this.plan].getChildByName("tool"),this.tool=this.toolNode.getChildByName("tool"),this.action=this.tasklist.children[this.plan].getChildByName("action"),this.mask=this.tasklist.children[this.plan].getChildByName("mask"),this.rect=this.tasklist.children[this.plan].getChildByName("rect"),this.startpos=this.tool.position,this.plan){case 0:for(var i=this.mask.getChildByName("flesh").children[0].x,c=this.mask.children[1].children[0].width,e=0;e<this.mask.getChildByName("flesh").childrenCount;e++){var o=this.mask.getChildByName("flesh").children[e];e>=1&&(o.x=i+c,c+=o.width,7===e&&(o.x-=2))}break;case 1:this.mask.x=-600,this.postween(this.mask,0,0);break;case 2:this.showSplash(),this.mask.x=-600,this.postween(this.mask,0,0);break;case 4:case 6:case 13:13===this.plan&&this.showSplash(),this.cleanpos=[],this.cleamposnum=0;var n=this.tool.children[0].width/4;for(t=0;t<720/n;t++)for(var s=0;s<1280/n;s++){var a=cc.v2(n*t-360,640-n*s),l=this.mask.getComponent(cc.PolygonCollider).points;this.containsPoint(a.x,a.y,l)&&this.cleanpos.push(a)}break;case 7:this.showSplash();break;case 8:this.showSplash(),this.action.position=cc.v3(0,0);var h=this.action.children[0].getChildByName("zj");this.action.children[0].getChildByName("rn").getComponent(cc.Sprite).fillStart=.2,h.y=-360;break;case 9:this.showSplash();break;case 10:break;case 11:this.showSplash()}cc.tween(this.toolNode).to(.5,{position:cc.v3(0,0)}).start(),this.tool.scale=.8,this.action.active=!1,this.tool.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.on(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.on(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)},i.prototype.TouchStart=function(t){this.isworking||(t.target.scale=1,a.default.playEffect(a.default.audioName.BUTTON),this.toolNode.getChildByName("tool_icon")&&(this.toolNode.getChildByName("tool_icon").active=!1),4!=this.plan&&6!=this.plan&&13!=this.plan||(this.tool.angle=45))},i.prototype.TouchSMove=function(t){if(!this.isworking){var i=this.node.convertToNodeSpaceAR(t.getLocation());if(this.tool.setPosition(this.tool.getPosition().add(t.getDelta().mul(.6666666666666666))),4==this.plan||6==this.plan||13==this.plan){var c=this.rect,e=cc.rect(c.x,c.y,c.width,c.height),o=cc.v2(i.x+this.tool.children[0].x,i.y+this.tool.children[0].y);n.default.rectPoint(o,e)&&this.Task5Func()}this.localnum,this.successnum}},i.prototype.BtnOffClick=function(){this.tool.off(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.off(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.off(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)},i.prototype.TouchSEnd=function(t){if(t.target.scale=.8,this.rect.getBoundingBoxToWorld().intersects(t.target.getBoundingBoxToWorld())){switch(this.plan){case 0:this.Task1Func();break;case 1:this.Task2Func();break;case 2:this.Task3Func();break;case 3:this.Task4Func();case 5:this.Task6Func();break;case 7:this.Mission8Handler();break;case 8:this.Mission9Handler();break;case 9:case 10:this.Task10Func();break;case 11:this.Task12Func();break;case 12:this.Task13Func();break;case 14:this.Task15Func()}this.playaudio("lv501_fang")}4!=this.plan&&6!=this.plan&&13!=this.plan||(this.cleamposnum>this.cleanpos.length/10*8?(this.localnum=this.successnum,this.rect.active=!1,this.SuccessFunc()):this.tool.angle=0),this.tool.position=this.startpos},i.prototype.fadetween=function(t,i){void 0===i&&(i=null),cc.tween(t).to(.5,{opacity:0}).call(function(){i&&i(),t.active=!1}).start()},i.prototype.postween=function(t,i,c,e){void 0===i&&(i=0),void 0===c&&(c=0),void 0===e&&(e=null),cc.tween(t).to(.5,{position:cc.v3(i,c)}).call(function(){e&&e()}).start()},i.prototype.Task1Func=function(){var t=this;this.action.active=!0,this.tool.active=!1;var i=this.action.getComponent(cc.Animation);i.play();var c=this.mask.getChildByName("flesh");i.once(cc.Animation.EventType.FINISHED,function(){t.rect.active=!0,t.fadetween(t.action);for(var i=0;i<c.childrenCount;i++){var e=c.children[i];i<4?e.x-=15*(4-i):e.x+=15*(i-4)}t.postween(t.rect.children[0],0,t.rect.children[0].y),t.scheduleOnce(function(){for(var i=0;i<c.childrenCount;i++){var e=c.children[i];cc.tween(e).to(.5,{position:cc.v3(e.x/2,0)}).to(.5,{y:-300,opacity:0}).start()}t.scheduleOnce(function(){t.rect.children[0].children[0].active=!0;var i=t.mask.children[1];t.postween(i,800,i.y),t.postween(t.mask.children[0],800,i.y),t.postween(t.rect.children[0],800,t.rect.children[0].y),t.scheduleOnce(function(){t.successnum=0,t.SuccessFunc()},.5)},1)},.5)})},i.prototype.showNode=function(t,i){for(var c=0;c<t.childrenCount;c++)t.children[c].active=c==i},i.prototype.Task2Func=function(){var t=this;this.action.active=!0,this.tool.active=!1,this.tool.children[0].active=!1;var i=this.mask.getChildByName("blender"),c=i.getChildByName("lid"),e=i.getChildByName("switch");cc.tween(this.action).to(1,{y:-250}).call(function(){c.y=375,c.active=!0,cc.tween(c).to(.5,{y:230}).call(function(){t.action.active=!1,e.children[0].active=!0,t.scheduleOnce(function(){t.successnum=0,t.SuccessFunc()},1)}).start()}).start()},i.prototype.playaudio=function(t){cc.audioEngine.stopAllEffects(),a.default.playEffect(t)},i.prototype.Task3Func=function(){var t=this;this.action.active=!0,this.tool.active=!1,this.mask.children[1].y=100,this.mask.children[1].active=!0,cc.tween(this.mask.children[1]).to(.5,{y:-37.814}).call(function(){t.scheduleOnce(function(){t.successnum=0,t.SuccessFunc()},.5)}).start()},i.prototype.Task4Func=function(){var t=this;this.action.active=!0,this.tool.active=!1,this.mask.children[1].opacity=0,this.mask.children[1].active=!0,cc.tween(this.mask.children[1]).to(.5,{opacity:255}).call(function(){t.scheduleOnce(function(){t.successnum=0,t.SuccessFunc()},.5)}).start()},i.prototype.Task5Func=function(){var t=this.tool.children[0],i=t.x+this.tool.x,c=t.y+this.tool.y;this._addCircle(cc.v2(i,c),t.width,t.height,this.mask),this.tool.children[0].active=!0;for(var e=0;e<this.cleanpos.length;e++)if(this.cleanpos[e]){var o=this.tool.x+t.x,n=this.tool.y+t.y;if(this.rectToPoints(this.cleanpos[e],cc.v2(o,n),t.width,t.height)){this.cleamposnum+=1,this.cleanpos[e]=null;var s=this.cleamposnum/(this.cleanpos.length/10*8);s>1?this.onRefreshProgressBar(1):(this.isplay||(this.isplay=!1),this.onRefreshProgressBar(s))}}},i.prototype.Task6Func=function(){var t=this;this.tool.active=!1,this.action.active=!0,cc.tween(this.action).to(.3,{position:cc.v3(275,0)}).to(.6,{position:cc.v3(145,105)}).to(.3,{position:cc.v3(-50,20)}).to(.5,{opacity:0}).call(function(){t.successnum=0,t.SuccessFunc()}).start(),cc.tween(this.mask.children[1]).delay(.2).to(1,{opacity:255}).start()},i.prototype.Mission8Handler=function(){var t=this;this.tool.active=!1,this.mask.active=!0;var i=this.mask.children[0].getChildByName("zj"),c=this.mask.children[0].getChildByName("rn").getComponent(cc.Sprite);c.fillRange=0,c.fillStart=0,cc.tween(c).to(1,{fillRange:1}).call(function(){i.active=!0}).delay(.5).call(function(){t.successnum=0,t.SuccessFunc()}).start()},i.prototype.Mission9Handler=function(){var t=this;this.tool.active=!1,this.action.active=!0;var i=this.action.children[0].getChildByName("zj"),c=this.action.children[0].getChildByName("rn").getComponent(cc.Sprite);cc.tween(this.action).call(function(){cc.tween(c).to(.5,{fillStart:.4}).start(),cc.tween(i).to(.5,{y:-305}).call(function(){t.mask.children[0].getComponent(cc.Sprite).enabled=!1,t.mask.children[0].children[0].active=!0}).start()}).delay(.5).to(.5,{x:115}).call(function(){cc.tween(c).to(.5,{fillStart:.65}).start(),cc.tween(i).to(.5,{y:-220}).call(function(){t.mask.children[1].getComponent(cc.Sprite).enabled=!1,t.mask.children[1].children[0].active=!0}).start()}).delay(.5).to(.5,{x:225}).call(function(){cc.tween(c).to(.5,{fillStart:1}).start(),cc.tween(i).to(.5,{y:-105}).call(function(){t.mask.children[2].getComponent(cc.Sprite).enabled=!1,t.mask.children[2].children[0].active=!0}).start()}).delay(.5).call(function(){t.successnum=0,t.SuccessFunc()}).start()},i.prototype.Task10Func=function(){var t=this;this.tool.active=!1,this.action.active=!0,this.action.y=50,this.postween(this.action,0,0,function(){t.scheduleOnce(function(){if(t.successnum=0,10===t.plan){t.rect.children[0].active=!0;var i=t.rect.children[0].children[0];cc.tween(i).by(1.5,{angle:-360}).start(),t.mask.children[1].active=!0,t.mask.children[1].opacity=0,cc.tween(t.mask.children[1]).by(1.5,{opacity:255}).delay(1).call(function(){t.SuccessFunc()}).start()}else t.SuccessFunc()})})},i.prototype.Task12Func=function(){var t=this;this.successnum=3,this.action.active=!0,this.tool.active=!1,cc.tween(this.action).to(.5,{x:0}).to(.5,{y:300}).call(function(){t.Task12tool(),t.localnum++}).delay(1.5).to(.5,{x:110,y:0}).to(.5,{y:300}).call(function(){t.Task12tool(),t.localnum++}).delay(1.5).to(.5,{x:220,y:0}).to(.5,{y:300}).call(function(){t.Task12tool(),t.localnum++}).to(.5,{opacity:0}).delay(1).call(function(){t.SuccessFunc()}).start()},i.prototype.Task12tool=function(){var t=this,i=this.mask.children[this.localnum];this.action.children[0].getComponent(cc.Animation).play(),this.action.children[0].getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){cc.tween(i.children[1]).by(.2,{x:30}).by(.5,{opacity:-255,y:50}).start(),cc.tween(i.children[2]).by(.2,{x:-30}).call(function(){t.isworking=!1}).by(.5,{opacity:-255,y:50}).call(function(){i.children[1].active=!1,i.children[2].active=!1}).start()},this)},i.prototype.Task13Func=function(){var t=this;this.successnum=3,this.action.active=!0,this.tool.active=!1,cc.tween(this.action).to(.5,{y:-200}).call(function(){t.showNode(t.mask.children[t.localnum],1),t.localnum++}).to(.5,{x:110,y:0}).to(.5,{y:-200}).call(function(){t.showNode(t.mask.children[t.localnum],1),t.localnum++}).to(.5,{x:220,y:0}).to(.5,{y:-200}).call(function(){t.showNode(t.mask.children[t.localnum],1),t.localnum++}).call(function(){t.SuccessFunc()}).start()},i.prototype.Task15Func=function(){var t=this;this.tool.active=!1,this.action.active=!0,cc.tween(this.action).to(.3,{position:cc.v3(275,0)}).call(function(){t.action.children[0].children[0].active=!0}).by(.1,{angle:15}).by(.1,{angle:-15}).by(.1,{angle:-15}).by(.1,{angle:15}).call(function(){t.action.children[0].children[0].active=!1}).to(.6,{position:cc.v3(145,105)}).call(function(){t.action.children[0].children[0].active=!0}).by(.1,{angle:15}).by(.1,{angle:-15}).by(.1,{angle:-15}).by(.1,{angle:15}).call(function(){t.action.children[0].children[0].active=!1}).to(.5,{opacity:0}).delay(2).call(function(){t.successnum=0,t.SuccessFunc()}).start(),cc.tween(this.mask).delay(.2).to(3,{opacity:255}).start()},i.prototype.SuccessFunc=function(){var t=this;this.successnum==this.localnum&&(this.BtnOffClick(),this.plan+=1,this.localnum=0,this.progressBar.node.opacity=0,this.plan==this.tasklist.childrenCount?cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){t.scc.active=!0,t.scheduleOnce(function(){t.node_ef_stars.active=!0},.5),t.scheduleOnce(function(){t.GameWin()},3)}).start():cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){t.UpNode()}).start())},i.prototype.containsPoint=function(t,i,c){for(var e=c.length,o=0,n=0;n<e;++n){var s=c[n].x,a=c[n].y,l=c[(n+1)%e].x,h=c[(n+1)%e].y;a!=h&&(i<Math.min(a,h)||i>=Math.max(a,h)||(i-a)*(l-s)/(h-a)+s>t&&o++)}return o%2==1},i.prototype.rectToPoints=function(t,i,c,e){return t.x>i.x-c&&t.x<i.x+c&&t.y>i.y-e&&t.y<i.y+e},i.prototype.GameWin=function(){this.node.getComponent(s.default).onGameSucc()},i.prototype.showSplash=function(){cc.Tween.stopAllByTarget(this.node_splash),this.node_splash.opacity=255,cc.tween(this.node_splash).to(1,{opacity:0},{easing:"fade"}).start()},i.prototype.onRefreshProgressBar=function(t){this.progressBar.progress=t,this.progressBar.node.opacity=255},i.prototype._addCircle=function(t,i,c,e){var o=e.getComponent(cc.Mask)._graphics,n=cc.color(0,0,0,255);o.circle(t.x,t.y,i),o.lineWidth=2,o.fillColor=n,o.fill()},o([r(cc.Node)],i.prototype,"tasklist",void 0),o([r([cc.String])],i.prototype,"titlelist",void 0),o([h],i)}(cc.Component);c.default=u,cc._RF.pop()},{AudioManager:void 0,LevelCtrl_CommonResult:void 0,MathTool:void 0}]},{},["lv501_23_Ctrl"]);