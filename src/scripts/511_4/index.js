window.__require=function e(t,i,o){function n(s,a){if(!i[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){return n(t[s][1][e]||e)},l,l.exports,e,t,i,o)}return i[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<o.length;s++)n(o[s]);return n}({lv511_4_levelCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"2a746SGxvdK/YD8JvFJOdMI","lv511_4_levelCtrl");var o=__extends,n=__decorate,c=__awaiter,s=__generator;Object.defineProperty(i,"__esModule",{value:!0});var a=e("LevelCtrl_CommonResult"),r=e("AssetManager"),h=e("AudioManager"),l=cc._decorator,u=l.ccclass,d=l.property,p=l.inspector,f=[{str:"\u4eb2\u7231\u7684\uff0c\u6211\u5305\u517b\u4f60\u5427\uff0c\u4f46\u4f60\u8981\u8ddf\u6211\u73a9\u4e2a\u6e38\u620f",audio:"lv511_4_1"},{str:"\u6211\u60f3\u7a7f\u666e\u901a\u70b9\uff0c\u4f60\u5148\u628a\u773c\u775b\u95ed\u4e00\u4e0b",audio:"lv511_4_2"}],v=[{str:"\u6211\u60f3\u7a7f\u666e\u901a\u70b9\uff0c\u4f60\u5148\u628a\u773c\u775b\u95ed\u4e00\u4e0b\uff0c\u4f60\u9009\u54ea\u4ef6\u6211\u5c31\u7a7f\u54ea\u4ef6",audio:"lv511_4_3"},{str:"\u90a3\u4e48\u8fd9\u4e24\u4ef6\u5462",audio:"lv511_4_4"},{str:"\u8fd9\u4ef6\u600e\u4e48\u6837\uff0c\u8981\u7a7f\u5417",audio:"lv511_4_5"},{str:"\u90a3\u8fd9\u4e00\u4ef6\u8863\u670d\u5462\uff0c\u8981\u4e0d\u8981\u7a7f\u5462",audio:"lv511_4_6"},{str:"\u6700\u540e\u4e00\u4e2a\uff0c\u4eb2\u7231\u7684\uff0c\u4f60\u60f3\u6211\u7a7f\u7ed9\u4f60\u770b\u5417",audio:"lv511_4_7"}],y=[[[{str:"\u4eb2\u7231\u7684\uff0c\u4f60\u773c\u5149\u771f\u597d",audio:"lv511_4_8"}],[{str:"\u90fd\u8bf4\u4e86\u4e0d\u60f3\u7a7f\u8fd9\u4e48\u534e\u4e3d\u7684\u8863\u670d\u4e86",audio:"lv511_4_9"}]],[[{str:"\u8fd9\u4ef6\u4e5f\u592a\u8c6a\u534e\u4e86\uff0c\u6211\u60f3\u505a\u4e2a\u666e\u901a\u7684\u5973\u5b69\uff01",audio:"lv511_4_10"}],[{str:"\u4eb2\u7231\u7684\uff0c\u7231\u4f60\u54e6\uff01",audio:"lv511_4_11"},{str:"\u4f60\u80af\u5b9a\u5077\u5077\u770b\u5230\u4e86\uff0c\u8fd9\u6b21\u6211\u8981\u6321\u4f4f",audio:"lv511_4_12"}]],[[{str:"\u4eb2\u7231\u7684\uff0c\u4f60\u9009\u7684\u592a\u68d2\u4e86",audio:"lv511_4_13"}],[{str:"\u4eb2\u7231\u7684\uff0c\u4f60\u9009\u7684\u90fd\u662f\u5565\u554a\uff01\u6211\u4e0d\u5f00\u5fc3\u4e86",audio:"lv511_4_14"}]],[[{str:"\u539f\u6765\u4f60\u53ea\u559c\u6b22\u6211\u5c0f\u5bcc\u5a46\u7684\u8eab\u4efd\uff0c\u6211\u5bf9\u4f60\u592a\u5931\u671b\u4e86",audio:"lv511_4_15"}],[{str:"\u4eb2\u7231\u7684\uff0c\u6211\u5c31\u77e5\u9053\u4f60\u6700\u61c2\u6211",audio:"lv511_4_16"}]],[[{str:"\u4eba\u5bb6\u5bb3\u7f9e\uff0c\u4e0d\u597d\u610f\u601d\u81ea\u5df1\u7a7f\u4e0a\uff0c\u4f60\u5e2e\u6211\u4e00\u4e0b",audio:"lv511_4_17"}],[{str:"\u4eb2\u7231\u7684\uff0c\u4f60\u771f\u7684\u5f88\u4e0d\u89e3\u98ce\u60c5\u8bf6",audio:"lv511_4_18"}]]],g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.role=null,t.table=null,t.hand=null,t.btns=null,t.slap=null,t.end=null,t.guide=null,t.endclothes=null,t.dialog=null,t._curAudioId=0,t.screen=null,t.curQuestion=-1,t.iserr=!1,t.isworking=!1,t.keeptime=0,t}return o(t,e),Object.defineProperty(t.prototype,"curAudioId",{get:function(){return this._curAudioId},set:function(e){-1!==this._curAudioId&&cc.audioEngine.stop(this._curAudioId),this._curAudioId=e},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.btns.active=!1,this.hand.active=!1,this.slap.active=!1,this.end.active=!1,this.dialog.active=!1,this.hideTableItem(),cc.tween(this.role).to(1,{scaleY:1.01}).to(1,{scaleY:1}).union().repeatForever().start(),r.default.loadSoundEffect_fileDir("AudioClip/lv_511/4",function(){e.initData()})},t.prototype.initData=function(){var e=this;this.showDialog1(f[0]),this.showface(4),this.scheduleOnce(function(){e.showQuestion()},this.keeptime)},t.prototype.BtnOnClick=function(){var e=this.endclothes;e.on(cc.Node.EventType.TOUCH_MOVE,this.TouchMove,this),e.on(cc.Node.EventType.TOUCH_END,this.TouchEnd,this),e.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchEnd,this)},t.prototype.BtnOffClick=function(){var e=this.endclothes;e.off(cc.Node.EventType.TOUCH_MOVE,this.TouchMove,this),e.off(cc.Node.EventType.TOUCH_END,this.TouchEnd,this),e.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchEnd,this)},t.prototype.TouchMove=function(e){this.endclothes.position=this.endclothes.parent.convertToNodeSpaceAR(e.getLocation())},t.prototype.TouchEnd=function(){var e=this,t=this.endclothes.getBoundingBoxToWorld(),i=this.role.getBoundingBoxToWorld();cc.Intersection.rectRect(i,t)&&this.showSplash(function(){e.playSuccess(),e.playsound("lv511_4_19")})},t.prototype.showQuestion=function(){var e=this;this.role.getChildByName("female"),this.curQuestion++,this.showDialog1(v[this.curQuestion]),0===this.curQuestion&&(this.keeptime=2.6),this.scheduleOnce(function(){switch(e.curQuestion>=0&&e.curQuestion<2&&(e.showface(2),e.playHand(function(){e.showTableItem(e.curQuestion)})),e.curQuestion){case 0:e.showTableItem(e.curQuestion);break;case 2:e.showface(3),e.showTableItem(e.curQuestion-2),e.btns.children[0].getComponentInChildren(cc.Label).string="\u7a7f",e.btns.children[1].getComponentInChildren(cc.Label).string="\u4e0d\u7a7f";break;case 3:e.showface(1),e.showTableItem(e.curQuestion-2),e.btns.children[0].getComponentInChildren(cc.Label).string="\u7a7f",e.btns.children[1].getComponentInChildren(cc.Label).string="\u4e0d\u7a7f";break;case 4:e.showface(3),e.btns.children[0].getComponentInChildren(cc.Label).string="\u7a7f",e.btns.children[1].getComponentInChildren(cc.Label).string="\u4e0d\u7a7f"}e.scheduleOnce(function(){e.showBtn()},.5)},this.keeptime),this.btns.children.forEach(function(t,i){return t.on(cc.Node.EventType.TOUCH_END,function(){return e.onClickBtn(i)},e)})},t.prototype.showTableItem=function(e){var t=this.table.getChildByName("left"),i=this.table.getChildByName("right"),o=this.table.getChildByName("centre");t.children.forEach(function(e){return e.active=!1}),i.children.forEach(function(e){return e.active=!1}),o.children.forEach(function(e){return e.active=!1}),this.curQuestion>=2?(t.active=!1,i.active=!1,o.active=!0,o.children[e]&&(o.children[e].active=!0)&&(o.children[e].opacity=0,o.children[e].y=100,cc.tween(o.children[e]).to(.5,{opacity:255,y:0}).start())):(t.children[e]&&(t.children[e].active=!0)&&(t.children[e].opacity=0,t.children[e].y=100,cc.tween(t.children[e]).to(.5,{opacity:255,y:0}).start()),i.children[e]&&(i.children[e].active=!0)&&(i.children[e].opacity=0,i.children[e].y=100,cc.tween(i.children[e]).set({opacity:0,y:100}).to(.5,{opacity:255,y:0}).start()))},t.prototype.hideTableItem=function(){var e=this.table.getChildByName("left"),t=this.table.getChildByName("right"),i=this.table.getChildByName("centre");e.children.forEach(function(e){return e.active=!1}),t.children.forEach(function(e){return e.active=!1}),i.children.forEach(function(e){return e.active=!1})},t.prototype.onClickBtn=function(e){var t=this;if(h.default.playEffect(h.default.audioName.BUTTON),this.btns.children.forEach(function(e){return e.off(cc.Node.EventType.TOUCH_END)}),this.btns.active=!1,this.curQuestion<2&&this.hideTableItem(),this.role.getChildByName("female"),0===e)switch(this.curQuestion){case 0:this.changeClothes(1),this.iserr=!1;break;case 1:this.changeClothes(0),this.iserr=!0;break;case 2:this.changeClothes(0),this.iserr=!1,this.hideTableItem();break;case 3:this.changeClothes(0),this.iserr=!0,this.hideTableItem();break;case 4:this.endclothes.active=!0,this.hideTableItem(),this.iserr=!1}else switch(this.curQuestion){case 0:this.changeClothes(0),this.iserr=!0;break;case 1:this.changeClothes(1),this.iserr=!1;break;case 2:this.iserr=!0;break;case 3:this.iserr=!1;break;case 4:this.endclothes.active=!0,this.hideTableItem(),this.iserr=!0}this.iserr?this.showface(5):this.showface(4),this.scheduleOnce(function(){t.showtriggerAnswer(e)},.5)},t.prototype.showtriggerAnswer=function(e){var t=this;this.curQuestion<2?this.hideHand(function(){t.iserr?(t.showDialog1(y[t.curQuestion][e][0]),t.scheduleOnce(function(){t.playSlap()},t.keeptime)):(t.showDialog1(y[t.curQuestion][e][0]),t.scheduleOnce(function(){1==t.curQuestion?(t.showDialog1(y[t.curQuestion][e][1]),t.scheduleOnce(function(){t.playscreen(function(){t.showQuestion()})},t.keeptime)):t.showQuestion()},t.keeptime+.5))}):this.hidescreen(function(){t.iserr?(t.showDialog1(y[t.curQuestion][e][0]),t.scheduleOnce(function(){t.playSlap()},t.keeptime)):(t.showDialog1(y[t.curQuestion][e][0]),t.scheduleOnce(function(){4==t.curQuestion?(t.BtnOnClick(),t.guide.active=!0):t.playscreen(function(){t.showQuestion()})},t.keeptime))})},t.prototype.changeClothes=function(e){void 0===e&&(e=0);var t=this.role.getChildByName("female"),i=null;0===e?(t.getChildByName("normal").active=!1,t.getChildByName("gorgeous").active=!0,this.shownode(t.getChildByName("gorgeous"),this.curQuestion),i=t.getChildByName("gorgeous").children[this.curQuestion]):(t.getChildByName("normal").active=!0,t.getChildByName("gorgeous").active=!1,this.shownode(t.getChildByName("normal"),this.curQuestion),i=t.getChildByName("normal").children[this.curQuestion]),this.curQuestion>=2&&(t.getChildByName("normal").active=!1,t.getChildByName("gorgeous").active=!1,t.getChildByName("clothes").active=!0,this.shownode(t.getChildByName("clothes"),this.curQuestion-2),i=t.getChildByName("clothes").children[this.curQuestion-2]),cc.tween(i).set({opacity:0,y:i.y+50}).by(.5,{opacity:255,y:-50}).call(function(){}).start()},t.prototype.playscreen=function(e){var t=this;this.screen.opacity=0,this.screen.active=!0;var i=this.screen.getComponent(cc.Animation);i.defaultClip.wrapMode=cc.WrapMode.Reverse,i.once(cc.Animation.EventType.FINISHED,function(){t.scheduleOnce(function(){e&&e()},1)},this),i.play(),this.hand.active=!0},t.prototype.hidescreen=function(e){var t=this;this.screen.opacity=0,this.screen.active=!0;var i=this.screen.getComponent(cc.Animation),o=i.defaultClip.name+"_out",n=i.getClips().find(function(e){return e.name===o})||i.defaultClip;n.wrapMode=cc.WrapMode.Normal,i.addClip(n,o),i.once(cc.Animation.EventType.FINISHED,function(){t.scheduleOnce(function(){e&&e()},1)},this),i.play(o),this.hand.active=!0},t.prototype.playHand=function(e){this.hand.getComponent(cc.Layout).spacingX=720;var t=this.hand.getComponent(cc.Animation);t.defaultClip.wrapMode=cc.WrapMode.Reverse,t.once(cc.Animation.EventType.FINISHED,function(){e&&e()},this),t.play(),this.hand.active=!0},t.prototype.hideHand=function(e){var t=this,i=this.hand.getComponent(cc.Animation),o=i.defaultClip.name+"_out",n=i.getClips().find(function(e){return e.name===o})||i.defaultClip;n.wrapMode=cc.WrapMode.Normal,i.addClip(n,o),i.once(cc.Animation.EventType.FINISHED,function(){t.scheduleOnce(function(){e&&e(),t.hand.active=!1},.5)}),i.play(o)},t.prototype.showBtn=function(){this.btns.getComponent(cc.Layout).spacingX=720;var e=this.btns.getComponent(cc.Animation);e.stop(),e.once(cc.Animation.EventType.FINISHED,function(){},this),e.play(),this.btns.active=!0},t.prototype.playSlap=function(e){var t=this;void 0===e&&(e=null),this.playsound("lv316_3_2"),this.slap.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){t.scheduleOnce(function(){e&&e(),t.slap.active=!1,t.playFail()},1)},this),this.slap.getComponent(cc.Animation).play(),this.slap.active=!0},t.prototype.playSentence=function(e){return c(this,void 0,void 0,function(){var t;return s(this,function(i){switch(i.label){case 0:return e.dId=e.dId||0,e.audio?(t=this,[4,h.default.playEffect(e.audio)]):[3,2];case 1:t.curAudioId=i.sent(),i.label=2;case 2:return[4,this.showDialog1(e)];case 3:return i.sent(),[2]}})})},t.prototype.playFail=function(){this.node.getComponent(a.default).onGameFail()},t.prototype.playSuccess=function(){var e=this;this.scheduleOnce(function(){e.node.getComponent(a.default).onGameSucc()},2),this.end.active=!0},t.prototype.showDialog1=function(e){this.isworking=!0,this.dialog.children[0].getComponent(cc.Label).string=e.str,this.keeptime=.2*e.str.length,this.dialog.active=!0,this.playsound(e.audio),this.unschedule(this.closeDialog1),this.scheduleOnce(this.closeDialog1,this.keeptime)},t.prototype.closeDialog1=function(){this.dialog.active=!1},t.prototype.showface=function(e){var t=this.role.getChildByName("female").getChildByName("face");switch(e){case 1:this.shownode(t,2);break;case 2:break;case 3:this.shownode(t,1);break;case 4:this.shownode(t,4);break;case 5:this.shownode(t,3)}},t.prototype.shownode=function(e,t){for(var i=0;i<e.childrenCount;i++)e.children[i].active=i===t},t.prototype.showSplash=function(e){var t=this;this.node.getChildByName("black1").active=!0,cc.Tween.stopAllByTarget(this.node.getChildByName("black1")),this.node.getChildByName("black1").opacity=0,cc.tween(this.node.getChildByName("black1")).to(.5,{opacity:255}).delay(.5).call(function(){e&&e()}).to(.5,{opacity:0}).call(function(){t.node.getChildByName("black1").active=!1}).start()},t.prototype.playsound=function(e,t){void 0===t&&(t=!1),t?h.default.playEffect(e):(h.default.pausesound(),h.default.playEffect1(e))},n([d(cc.Node)],t.prototype,"role",void 0),n([d(cc.Node)],t.prototype,"table",void 0),n([d(cc.Node)],t.prototype,"hand",void 0),n([d(cc.Node)],t.prototype,"btns",void 0),n([d(cc.Node)],t.prototype,"slap",void 0),n([d(cc.Node)],t.prototype,"end",void 0),n([d(cc.Node)],t.prototype,"guide",void 0),n([d(cc.Node)],t.prototype,"endclothes",void 0),n([d(cc.Node)],t.prototype,"dialog",void 0),n([d(cc.Node)],t.prototype,"screen",void 0),n([u,p("packages://autoproperty//inspector.js")],t)}(cc.Component);i.default=g,cc._RF.pop()},{AssetManager:void 0,AudioManager:void 0,LevelCtrl_CommonResult:void 0}]},{},["lv511_4_levelCtrl"]);