window.__require=function e(t,c,i){function s(n,r){if(!c[n]){if(!t[n]){var a=n.split("/");if(a=a[a.length-1],!t[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+n+"'")}n=a}var l=c[n]={exports:{}};t[n][0].call(l.exports,function(e){return s(t[n][1][e]||e)},l,l.exports,e,t,c,i)}return c[n].exports}for(var o="function"==typeof __require&&__require,n=0;n<i.length;n++)s(i[n]);return s}({Clean7:[function(e,t,c){"use strict";cc._RF.push(t,"10e0f8ICP5Jh4UQi6QYHR19","Clean7");var i=__extends,s=__decorate;Object.defineProperty(c,"__esModule",{value:!0});var o=e("Game"),n=e("AudioManager"),r=cc._decorator,a=r.ccclass,h=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.process=[],t.title=[],t.clean=null,t.cleanRect=null,t.cleanMask=null,t.clean_bar=null,t.sizenode=null,t.title_lable=null,t.currect=null,t.successEffectNode=null,t.hairPre=null,t.hairPre1=null,t.currpro=0,t.startposX=0,t.startposY=-400,t.currnum=0,t.cleanpos=[],t.cleamposnum=0,t.titlelable=["\u6b65\u9aa41\uff1a\u7528\u6c34\u51b2\u6d17","\u6b65\u9aa42\uff1a\u64e6\u5e72\u51c0","\u6b65\u9aa43\uff1a\u6324\u4e0a\u6ce1\u6cab\u5237\u4e00\u904d","\u6b65\u9aa44\uff1a\u7528\u5c0f\u5200\u522e\u53bb\u6bdb\u6bdb","\u6b65\u9aa45\uff1a\u7528\u7535\u52a8\u7802\u8f6e\u6253\u78e8\u6307\u7532\u989c\u8272","\u6b65\u9aa46\uff1a\u7528\u5c0f\u5200\u628a\u6307\u7532\u522e\u6389","\u6b65\u9aa47\uff1a\u7528\u68c9\u7b7e\u5904\u7406\u4e0b\u811a\u6307\u7532\u7684\u6d53\u6c34","\u6b65\u9aa48\uff1a\u6307\u7532\u526a\u526a\u6389\u811a\u6307\u7532","\u6b65\u9aa49\uff1a\u53bb\u9664\u811a\u6307\u7532\u5185\u7684\u6c61\u57a2","\u6b65\u9aa410\uff1a\u7ed9\u53d7\u4f24\u7684\u6307\u7532\u55b7\u4e0a\u62a4\u7406\u6db2","\u6b65\u9aa411\uff1a\u56fe\u4e0a\u6307\u7532\u6cb9"],t.process_2=[],t.title_2=[],t.sizenode_2=null,t.isrect=!0,t.creattime=0,t.currpro_2=0,t}return i(t,e),t.prototype.onLoad=function(){this.updateTask(),this.titlelable=this.title,this.sizenode_2.active=!1},t.prototype.containsPoint=function(e,t,c){for(var i=c.length,s=0,o=0;o<i;++o){var n=c[o].x,r=c[o].y,a=c[(o+1)%i].x,h=c[(o+1)%i].y;r!=h&&(t<Math.min(r,h)||t>=Math.max(r,h)||(t-r)*(a-n)/(h-r)+n>e&&s++)}return s%2==1},t.prototype.start=function(){this.UpProcess()},t.prototype.CleanTouchStart=function(){},t.prototype.CleanTouchMove=function(e){this.clean.x+=e.getDeltaX()/this.sizenode.scaleX,this.clean.y+=e.getDeltaY()/this.sizenode.scaleY;var t,c=this.cleanRect.x+this.clean.x,i=this.cleanRect.y+this.clean.y;this._addCircle(cc.v2(c,i),this.cleanRect.width,this.cleanRect.height,this.cleanMask),this.clean.children[0].active=!0;for(var s=function(){if(o.cleanpos[n]){var e=o.clean.x+o.cleanRect.x,c=o.clean.y+o.cleanRect.y;if(o.rectToPoints(o.cleanpos[n],cc.v2(e,c),o.cleanRect.width,o.cleanRect.height)){if(0==o.currpro){if((t=(new Date).getTime())-o.creattime>=50&&(o.creattime=t,o.hairPre)){var i=cc.instantiate(o.hairPre);i.parent=o.clean.parent,i.position=o.cleanpos[n],i.angle=Math.floor(180*Math.random()),cc.tween(i).by(.5,{position:cc.v3(0,-100)}).call(function(){i&&i.destroy()}).start()}}else if(1==o.currpro&&(t=(new Date).getTime())-o.creattime>=50&&(o.creattime=t,o.hairPre1)){var s=cc.instantiate(o.hairPre1);s.parent=o.clean.parent,s.position=o.cleanpos[n],s.angle=Math.floor(180*Math.random()),cc.tween(s).by(.5,{position:cc.v3(0,-100)}).call(function(){s&&s.destroy()}).start()}o.cleamposnum+=1,o.cleanpos[n]=null,o.cleamposnum>o.cleanpos.length/10*9?o.clean_bar.getComponent(cc.ProgressBar).progress=1:o.clean_bar.getComponent(cc.ProgressBar).progress=o.cleamposnum/(o.cleanpos.length/10*9)}}},o=this,n=0;n<this.cleanpos.length;n++)s()},t.prototype.CleanTouchEnd=function(){cc.audioEngine.stopAllEffects(),this.clean.x=this.startposX,this.clean.y=this.startposY,this.clean.children[0].active=!1,this.cleamposnum>this.cleanpos.length/10*9&&(n.default.playEffect(n.default.audioName.FINDWORD_SUCCESS),this.currpro++,this.updateTask(),this.UpProcess(),this.CleanOff())},t.prototype.CleanOff=function(){var e=this;this.currect.active=!0,this.scheduleOnce(function(){e.currect.active=!1},.5)},t.prototype.updateTask=function(){if(this.currpro>=this.process.length)return this.clean.active=!1,void(this.process_2.length>0&&(this.sizenode.active=!1));this.clean_bar.getComponent(cc.ProgressBar).progress=0,this.clean=this.process[this.currpro].getChildByName("gongju"),this.startposY=this.clean.y,this.cleanRect=this.clean.children[1],this.clean.on(cc.Node.EventType.TOUCH_START,this.CleanTouchStart,this),this.clean.on(cc.Node.EventType.TOUCH_MOVE,this.CleanTouchMove,this),this.clean.on(cc.Node.EventType.TOUCH_END,this.CleanTouchEnd,this),this.clean.zIndex=cc.macro.MAX_ZINDEX;var e=this.sizenode.width,t=this.sizenode.height;this.cleanpos=[],this.cleamposnum=0;for(var c=this.cleanRect.width/4,i=0;i<e/c;i++)for(var s=0;s<t/c;s++){var o=cc.v2(-e/2+c*i,t/2-c*s),n=this.process[this.currpro].getChildByName("mask").getComponent(cc.PolygonCollider).points;this.containsPoint(o.x,o.y,n)&&this.cleanpos.push(o)}},t.prototype.UpProcess=function(){var e=this;if(this.currpro>=this.process.length)if(this.process_2.length>0)this.upSizeNode_2(),this.updateTask_2();else{this.sizenode_2.active=!1,this.successEffectNode.active=!0;for(var t=function(){var t=50*i,s=i;c.scheduleOnce(function(){e.successEffectNode.children[s].active=!0},.001*t)},c=this,i=0;i<this.successEffectNode.childrenCount;i++)t();this.scheduleOnce(this.onGameSucc,2)}else{this.currnum=0;for(var s=0;s<this.process.length;s++)s==this.currpro?(this.process[s].active=!0,this.currnum=s,this.cleanMask=this.process[this.currnum].getChildByName("mask"),cc.tween(this.process[s].getChildByName("gongju")).to(1,{position:cc.v3(0,this.process[s].getChildByName("gongju").y)}).start()):this.process[s].active=!1;this.title_lable&&(this.title_lable.getComponent(cc.Label).string=this.titlelable[this.currpro])}},t.prototype.onGameSucc=function(){cc.find("Canvas/game").getComponent(o.default).answerCrrect({position:cc.Vec2.ZERO,show:!0})},t.prototype._addCircle=function(e,t,c,i){var s=i.getComponent(cc.Mask)._graphics,o=cc.color(0,0,0,255);s.circle(e.x,e.y,t),s.lineWidth=2,s.fillColor=o,s.fill()},t.prototype.rectToPoints=function(e,t,c,i){return e.x>t.x-c&&e.x<t.x+c&&e.y>t.y-i&&e.y<t.y+i},t.prototype.upSizeNode_2=function(){var e=this;this.sizenode_2.active=!0;for(var t=0;t<this.sizenode_2.childrenCount;t++)this.sizenode_2.children[t].active=!1;if(this.currpro_2!=this.process_2.length){for(this.sizenode_2.children[this.currpro_2].active=!0,this.currnum=0,s=0;s<this.process_2.length;s++)if(s==this.currpro_2){if(this.process_2[s].active=!0,this.currnum=s,this.cleanMask=this.process_2[this.currnum].getChildByName("di").getChildByName("mask"),this.process_2[this.currnum].getChildByName("di").getChildByName("sp")&&(this.sp=this.process_2[this.currnum].getChildByName("di").getChildByName("sp")),this.cleanMask.childrenCount>0)for(t=0;t<this.cleanMask.childrenCount;t++)this.cleanMask.children[t].active=0==t;1!=this.currpro_2&&4!=this.currpro_2&&cc.tween(this.process_2[s].getChildByName("gongju")).to(1,{position:cc.v3(0,this.process_2[s].getChildByName("gongju").y)}).start()}else this.process_2[s].active=!1;this.title_lable.getComponent(cc.Label).string=this.title_2[this.currpro_2]}else{this.sizenode_2.children[this.currpro_2-1].active=!1,this.successEffectNode.active=!0,this.node.getChildByName("success").active=!0;for(var c=function(){var t=50*s,c=s;i.scheduleOnce(function(){e.successEffectNode.children[c].active=!0},.001*t)},i=this,s=0;s<this.successEffectNode.childrenCount;s++)c();this.scheduleOnce(this.onGameSucc,2)}},t.prototype.updateTask_2=function(){this.currpro_2!=this.process_2.length?(1!=this.currpro_2&&4!=this.currpro_2?(this.clean_bar.getComponent(cc.ProgressBar).progress=0,n.default.playEffect(n.default.audioName.CAT)):this.clean_bar.getComponent(cc.ProgressBar).progress=.5,this.clean=this.process_2[this.currpro_2].getChildByName("gongju"),this.startposY=this.clean.y,this.cleanRect=this.process_2[this.currpro_2].getChildByName("rect"),this.clean.on(cc.Node.EventType.TOUCH_START,this.RectTouchStart,this),this.clean.on(cc.Node.EventType.TOUCH_MOVE,this.RectTouchMove,this),this.clean.on(cc.Node.EventType.TOUCH_END,this.RectTouchEnd,this),this.clean.on(cc.Node.EventType.TOUCH_CANCEL,this.RectTouchcancel,this),this.cleanRect.zIndex=cc.macro.MAX_ZINDEX):this.clean.active=!1},t.prototype.RectTouchStart=function(e){3==this.cleanMask.childrenCount&&(this.cleanMask.children[0].active=!1,this.cleanMask.children[2].active=!0),this.cleanRect.active=!0,this.cleanRect.x=this.clean.convertToNodeSpaceAR(e.getLocation()).x,this.cleanRect.y=this.clean.convertToNodeSpaceAR(e.getLocation()).y+this.clean.y,this.clean.childrenCount>0&&(this.clean.children[0].active=!1),this.sp&&(this.sp.active=!1),5!=this.currpro_2&&6!=this.currpro_2||(this.clean.opacity=0)},t.prototype.RectTouchMove=function(e){this.cleanRect.x=this.clean.convertToNodeSpaceAR(e.getLocation()).x,this.cleanRect.y=this.clean.convertToNodeSpaceAR(e.getLocation()).y+this.clean.y},t.prototype.RectTouchEnd=function(){this.EndFunc()},t.prototype.RectTouchcancel=function(){this.EndFunc()},t.prototype.EndFunc=function(){this.cleanRect.active=!1,3==this.cleanMask.childrenCount&&(this.cleanMask.children[0].active=!0,this.cleanMask.children[2].active=!1),this.clean.childrenCount>0&&(this.clean.children[0].active=!0),this.sp&&(this.sp.active=!0),5!=this.currpro_2&&6!=this.currpro_2||(this.clean.opacity=255);var e=cc.rect(this.cleanRect.x,this.cleanRect.y,this.cleanRect.width,this.cleanRect.height);this.CheckPoint(e,this.cleanMask.getComponent(cc.PolygonCollider).points)&&(this.cleanMask.children[0].active=!1,this.cleanMask.children[1].active=!0,this.currpro_2++,this.upSizeNode_2(),this.updateTask_2())},t.prototype.CheckPoint=function(e,t){return!!cc.Intersection.rectPolygon(e,t)},s([h([cc.Node])],t.prototype,"process",void 0),s([h([cc.String])],t.prototype,"title",void 0),s([h(cc.Node)],t.prototype,"clean_bar",void 0),s([h(cc.Node)],t.prototype,"sizenode",void 0),s([h(cc.Node)],t.prototype,"title_lable",void 0),s([h(cc.Node)],t.prototype,"currect",void 0),s([h(cc.Node)],t.prototype,"successEffectNode",void 0),s([h(cc.Prefab)],t.prototype,"hairPre",void 0),s([h(cc.Prefab)],t.prototype,"hairPre1",void 0),s([h([cc.Node])],t.prototype,"process_2",void 0),s([h([cc.String])],t.prototype,"title_2",void 0),s([h(cc.Node)],t.prototype,"sizenode_2",void 0),s([a],t)}(cc.Component);c.default=l,cc._RF.pop()},{AudioManager:void 0,Game:void 0}]},{},["Clean7"]);