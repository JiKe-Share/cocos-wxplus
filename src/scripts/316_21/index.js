window.__require=function t(e,n,i){function o(c,a){if(!n[c]){if(!e[c]){var u=c.split("/");if(u=u[u.length-1],!e[u]){var s="function"==typeof __require&&__require;if(!a&&s)return s(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+c+"'")}c=u}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return o(e[c][1][t]||t)},l,l.exports,t,e,n,i)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<i.length;c++)o(i[c]);return o}({"316_21_LevelCtrl":[function(t,e,n){"use strict";cc._RF.push(e,"1666dcGg8VGYJqKkYyIIvV+","316_21_LevelCtrl");var i=__extends,o=__decorate,r=__awaiter,c=__generator;Object.defineProperty(n,"__esModule",{value:!0});var a=t("LevelCtrl_CommonResult"),u=t("AssetManager"),s=t("AudioManager"),l=t("316_AudioConfig"),d=t("316_DialogSys"),h=t("316_AudioFunc"),v=cc._decorator,p=v.ccclass,f=v.property,y=[{str:"\u4eb2\u7231\u7684\uff0c\u6211\u4eec\u6765\u73a9\u4e2a\u6e38\u620f\u5427",audio:"lv316_21_0-1"},{str:"\u4f60\u628a\u773c\u775b\u5148\u6321\u4e00\u4e0b\uff0c\u4f60\u9009\u4ec0\u4e48\u6211\u5c31\u7a7f\u4ec0\u4e48",audio:"lv316_21_0-2"}],_=[{str:"\u8fd9\u4e24\u4e2a\u88d9\u5b50\uff0c\u4f60\u9009\u4e00\u4e2a\u5427",audio:"lv316_21_0-3"},{str:"\u4eb2\u7231\u7684\uff0c\u5e2e\u6211\u9009\u4e2a\u889c\u5b50\u5427",audio:"lv316_21_2-1"},{str:"\u6700\u540e\u4e00\u4e2a\uff0c\u5e2e\u6211\u9009\u4e2a\u5916\u5957\u5427",audio:"lv316_21_3-1"},{str:"\u4eb2\u7231\u7684\uff0c\u6211\u8fd8\u662f\u89c9\u5f97\u53e6\u4e00\u5957\u597d\u770b\u8bf6\uff0c\u8981\u4e0d\u8981\u6362\u53e6\u4e00\u5957\u5462",audio:"lv316_21_4-1"},{str:"\u5916\u9762\u6709\u70b9\u51b7\uff0c\u8fd9\u6837\u51fa\u53bb\u7a7f\u592a\u5c11\u4e86\uff0c\u8981\u4e0d\u53bb\u5065\u8eab\u623f\u70ed\u8eab\u4e00\u4e0b\u5427\uff1f",audio:"lv316_21_5-1"}],g=[[[{str:"\u4eb2\u7231\u7684\uff0c\u6211\u7a7f\u8fd9\u4e2a\u597d\u770b\u5427",audio:"lv316_21_1-1"},{str:"\u54b1\u4eec\u7ee7\u7eed\u9009\u5427",dId:1}],[{str:"\u539f\u6765\u4f60\u559c\u6b22\u8fd9\u79cd\u98ce\u683c\u7684\u554a",audio:"lv316_21_1-2"}]],[[{str:"\u4f60\u7edd\u5bf9\u5077\u770b\u4e86\uff0c\u4e0d\u884c\u8fd9\u6b21\u6211\u8981\u6321\u7740",audio:"lv316_21_2-2"}],[{str:"\u4f60\u662f\u4e0d\u662f\u5077\u770b\u4e86\uff0c\u4e0d\u884c\u8fd9\u6b21\u6211\u8981\u6321\u7740",audio:"lv316_21_2-3"}]],[[{str:"\u8fd9\u5957\u548b\u6837\uff0c\u597d\u770b\u5417\uff1f",audio:"lv316_21_3-2"}],[{str:"\u563f\u563f\uff0c\u8fd9\u8fd8\u62ff\u4e0d\u4e0b\u4f60",audio:"lv316_21_3-3"}]],[[{str:"\u54fc\uff0c\u6211\u7a7f\u8fd9\u5957\u5c31\u4e0d\u597d\u770b\u5417\uff0c",audio:"lv316_21_4-2"}],[{str:"\u4e0d\u7528\u6362\u5b9d\u8d1d\uff0c\u4f60\u7a7f\u54ea\u4e00\u5957\u90fd\u597d\u770b",dId:1,audio:"lv316_21_4-3"},{str:"\u563f\u563f\uff0c\u4eb2\u7231\u7684\u4f60\u5634\u771f\u751c",audio:"lv316_21_4-4"}]],[[{str:"\u5b9d\u8d1d\u54b1\u4eec\u8d70\uff0c\u6211\u521a\u597d\u60f3\u53bb\u8fd0\u52a8\u4e00\u4e0b\uff01",dId:1,audio:"lv316_21_5-2"},{str:"\u4eb2\u7231\u7684\uff0c\u6211\u6362\u8863\u670d\u6709\u70b9\u9ebb\u70e6\uff0c\u4f60\u5e2e\u6211\u6362\u4e00\u4e0b\u5427",audio:"lv316_21_5-3"}],[{str:"\u7b97\u4e86\u5427\uff0c\u8fd8\u662f\u5916\u9762\u597d\u73a9\u4e00\u70b9\uff01",dId:1,audio:"lv316_21_5-4"},{str:"\u81ed\u76f4\u7537\u4e00\u70b9\u90fd\u4e0d\u61c2\u98ce\u60c5\uff0c\u4f60\u559c\u6b22\u53bb\u5916\u9762\u5c31\u81ea\u5df1\u53bb\uff01",audio:"lv316_21_5-5"}]]],m={str:"\u8fd9\u5957\u7a7f\u642d\u771f\u7684\u5f88\u96be\u770b\uff0c\u7a7f\u6210\u8fd9\u6837\u600e\u4e48\u51fa\u95e8\uff01",audio:"lv316_21_3-4"},C=[["blue","jk"],["white","black"],["blue","jk"]],b=[{str:"\u624d\u60f3\u8d77\u6765\u6211\u4e00\u4e2a\u5355\u8eab\u72d7\uff0c\u54ea\u6765\u7684\u5973\u670b\u53cb\u554a",dId:1,audio:"lv316_21_6"}],N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.role=null,e.table=null,e.hand=null,e.btn=null,e.slap=null,e.end=null,e.guide=null,e.dialog=null,e._curAudioId=-1,e.curQuestion=-1,e}return i(e,t),Object.defineProperty(e.prototype,"curAudioId",{get:function(){return this._curAudioId},set:function(t){-1!==this._curAudioId&&cc.audioEngine.stop(this._curAudioId),this._curAudioId=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;this.btn.active=!1,this.hand.active=!1,this.slap.active=!1,this.end.active=!1,this.guide.active=!1,this.dialog=this.node.getComponentInChildren(d.default),this.hideTableItem(),cc.tween(this.role).to(1,{scaleY:1.01}).to(1,{scaleY:1}).union().repeatForever().start(),u.default.loadSoundEffect_fileDir("AudioClip/lv_316/21",function(){return r(t,void 0,void 0,function(){var t,e,n;return c(this,function(i){switch(i.label){case 0:t=0,e=y,i.label=1;case 1:return t<e.length?(n=e[t],[4,this.playSentence(n)]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[4,this.playHand()];case 5:return i.sent(),this.showQuestion(),[2]}})})})},e.prototype.showQuestion=function(){return r(this,void 0,void 0,function(){var t=this;return c(this,function(e){switch(e.label){case 0:return this.role.getChildByName("female"),this.curQuestion++,[4,this.playSentence(_[this.curQuestion])];case 1:return e.sent(),this.curQuestion>0&&this.curQuestion<2?[4,this.playHand()]:[3,3];case 2:e.sent(),e.label=3;case 3:switch(this.curQuestion){case 3:this.btn.children[0].getComponentInChildren(cc.Label).string="\u6362",this.btn.children[1].getComponentInChildren(cc.Label).string="\u4e0d\u6362";break;case 4:this.btn.children[0].getComponentInChildren(cc.Label).string="\u53bb",this.btn.children[1].getComponentInChildren(cc.Label).string="\u4e0d\u53bb"}return this.showTableItem(this.curQuestion),[4,this.showBtn()];case 4:return e.sent(),this.btn.children.forEach(function(e,n){return e.on(cc.Node.EventType.TOUCH_END,function(){return t.onClickBtn(n)},t)}),[2]}})})},e.prototype.showTableItem=function(t){var e=this.table.getChildByName("left"),n=this.table.getChildByName("right");e.children.forEach(function(t){return t.active=!1}),n.children.forEach(function(t){return t.active=!1}),e.children[t]&&(e.children[t].active=!0)&&cc.tween(e.children[t]).set({opacity:0,y:100}).to(.5,{opacity:255,y:0}).start(),n.children[t]&&(n.children[t].active=!0)&&cc.tween(n.children[t]).set({opacity:0,y:100}).to(.5,{opacity:255,y:0}).start()},e.prototype.hideTableItem=function(){var t=this.table.getChildByName("left"),e=this.table.getChildByName("right");t.children.forEach(function(t){return t.active=!1}),e.children.forEach(function(t){return t.active=!1})},e.prototype.onClickBtn=function(t){return r(this,void 0,void 0,function(){var e,n,i,o,r,a,u,l,d,h,v,p=this;return c(this,function(c){switch(c.label){case 0:switch(s.default.playEffect(s.default.audioName.BUTTON),this.btn.children.forEach(function(t){return t.off(cc.Node.EventType.TOUCH_END)}),this.btn.active=!1,this.hideTableItem(),e=this.role.getChildByName("female"),n=null,this.curQuestion){case 0:n=e.getChildByName("inner");break;case 2:n=e.getChildByName("outer");break;case 1:n=e.getChildByName("stockings")}return this.curQuestion<3?(i=C[this.curQuestion][t],[4,this.changeClothes(n,i)]):[3,3];case 1:return c.sent(),this.curQuestion<2?[4,this.hideHand()]:[3,3];case 2:c.sent(),c.label=3;case 3:return o=e.getChildByName("inner"),r=e.getChildByName("outer"),4===this.curQuestion&&1===t&&(e.getChildByName("red").active=!1),3===this.curQuestion&&0===t&&(e.getChildByName("angry").active=!0),4===this.curQuestion&&1===t&&(e.getChildByName("angry").active=!0),2!==this.curQuestion||o.children.find(function(t){return t.active}).name===r.children.find(function(t){return t.active}).name?[3,6]:(e.getChildByName("red").active=!1,e.getChildByName("angry").active=!0,[4,this.playSentence(m)]);case 4:return c.sent(),[4,this.playSlap()];case 5:return c.sent(),this.playFail(),[2];case 6:a=g[this.curQuestion][t],u=0,l=a,c.label=7;case 7:return u<l.length?(d=l[u],[4,this.playSentence(d)]):[3,10];case 8:c.sent(),c.label=9;case 9:return u++,[3,7];case 10:return h=this.table.getChildByName("muban"),1===this.curQuestion?h.active=!0:h.active&&cc.tween(h).by(.5,{opacity:-255,y:50}).call(function(){return h.active=!1}).start(),3!==this.curQuestion||0!==t?[3,12]:[4,this.playSlap()];case 11:return c.sent(),this.playFail(),[2];case 12:return 3===this.curQuestion&&1===t&&(e.getChildByName("red").active=!0),4===this.curQuestion&&0===t?(v=0,this.role.on(cc.Node.EventType.TOUCH_MOVE,function(t){p.guide.active&&(p.guide.active=!1),(v+=t.getDelta().mag())>50&&(p.role.off(cc.Node.EventType.TOUCH_MOVE),p.playSuccess()),o.setPosition(o.getPosition().add(t.getDelta().mul(.6666666666666666))),r.setPosition(r.getPosition().add(t.getDelta().mul(.6666666666666666)))},this),this.guide.active=!0,[2]):4!==this.curQuestion||1!==t?[3,14]:[4,this.playSlap()];case 13:return c.sent(),this.playFail(),[2];case 14:return this.showQuestion(),[2]}})})},e.prototype.changeClothes=function(t,e){return r(this,void 0,void 0,function(){var n=this;return c(this,function(){return[2,new Promise(function(i){var o;if(!t)return i();null===(o=t.children)||void 0===o||o.forEach(function(t){t.active&&n.scheduleOnce(function(){t.active=!1},.5),t.name===e&&(t.active=!0,cc.tween(t).set({opacity:0,y:50}).to(.5,{opacity:255,y:0}).call(function(){return i()}).start())})})]})})},e.prototype.playHand=function(){return r(this,void 0,void 0,function(){var t=this;return c(this,function(){return[2,new Promise(function(e){var n=t.hand.getComponent(cc.Animation);n.once(cc.Animation.EventType.FINISHED,function(){t.scheduleOnce(function(){return e()},1)},t),t.hand.active=!0,n.play()})]})})},e.prototype.hideHand=function(){return r(this,void 0,void 0,function(){var t=this;return c(this,function(){return[2,new Promise(function(e){var n=t.hand.getComponent(cc.Animation);n.once(cc.Animation.EventType.FINISHED,function(){t.scheduleOnce(function(){e(),t.hand.active=!1},1)},t),t.hand.active=!0,n.play("fadeOut")})]})})},e.prototype.showBtn=function(){return r(this,void 0,void 0,function(){var t=this;return c(this,function(){return[2,new Promise(function(e){var n=t.btn.getComponent(cc.Animation);n.stop(),n.once(cc.Animation.EventType.FINISHED,function(){e()},t),t.btn.active=!0,n.play()})]})})},e.prototype.playSlap=function(){return r(this,void 0,void 0,function(){var t=this;return c(this,function(){return[2,new Promise(function(e){t.slap.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){h.playCommonEffect_316(l.default.slap),t.scheduleOnce(function(){e(),t.slap.active=!1},1)},t),t.slap.active=!0,t.slap.getComponent(cc.Animation).play()})]})})},e.prototype.playSentence=function(t){return r(this,void 0,void 0,function(){var e;return c(this,function(n){switch(n.label){case 0:return t.dId=t.dId||0,t.audio?(e=this,[4,s.default.playEffect(t.audio)]):[3,2];case 1:e.curAudioId=n.sent(),n.label=2;case 2:return[4,this.dialog.showDialog(t.str,t.dId)];case 3:return n.sent(),[2]}})})},e.prototype.playFail=function(){this.node.getComponent(a.default).onGameFail()},e.prototype.playSuccess=function(){var t=this,e=this.end.getComponent(cc.Animation);this.scheduleOnce(function(){return r(t,void 0,void 0,function(){var t,e,n;return c(this,function(i){switch(i.label){case 0:t=0,e=b,i.label=1;case 1:return t<e.length?(n=e[t],[4,this.playSentence(n)]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return this.node.getComponent(a.default).onGameSucc(),[2]}})})},2),this.end.active=!0,e.play()},o([f(cc.Node)],e.prototype,"role",void 0),o([f(cc.Node)],e.prototype,"table",void 0),o([f(cc.Node)],e.prototype,"hand",void 0),o([f(cc.Node)],e.prototype,"btn",void 0),o([f(cc.Node)],e.prototype,"slap",void 0),o([f(cc.Node)],e.prototype,"end",void 0),o([f(cc.Node)],e.prototype,"guide",void 0),o([p],e)}(cc.Component);n.default=N,cc._RF.pop()},{"316_AudioConfig":void 0,"316_AudioFunc":void 0,"316_DialogSys":void 0,AssetManager:void 0,AudioManager:void 0,LevelCtrl_CommonResult:void 0}]},{},["316_21_LevelCtrl"]);