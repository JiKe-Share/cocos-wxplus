window.__require=function t(e,i,o){function c(n,a){if(!i[n]){if(!e[n]){var l=n.split("/");if(l=l[l.length-1],!e[l]){var h="function"==typeof __require&&__require;if(!a&&h)return h(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+n+"'")}n=l}var r=i[n]={exports:{}};e[n][0].call(r.exports,function(t){return c(e[n][1][t]||t)},r,r.exports,t,e,i,o)}return i[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<o.length;n++)c(o[n]);return c}({lv501_13_Ctrl:[function(t,e,i){"use strict";cc._RF.push(e,"2eb447cSilHcoFRL2++P6gZ","lv501_13_Ctrl");var o=__extends,c=__decorate;Object.defineProperty(i,"__esModule",{value:!0});var s=t("Game"),n=t("AudioManager"),a=cc._decorator,l=a.ccclass,h=a.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tasklist=null,e.titlelist=[],e.dd=null,e.successnum=9,e.localnum=0,e.plan=0,e.cleanpos=[],e.cleamposnum=0,e.progressBar=null,e.node_splash=null,e.node_ef_stars=null,e.isworking=!1,e.bq=null,e.actionNum=0,e.isplay=!1,e.count=0,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.dd=this.node.getChildByName("dd"),this.title=this.node.getChildByName("title"),this.progressBar=this.node.getChildByName("progressBar").getComponent(cc.ProgressBar),this.node_ef_stars=this.node.getChildByName("ef_stars"),this.node_splash=this.node.getChildByName("splash"),this.UpNode(),cc.sys.isBrowser&&cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){e.keyCode==cc.macro.KEY.space&&(t.plan++,t.UpNode())},this)},e.prototype.UpNode=function(){for(var t=0;t<this.tasklist.childrenCount;t++)t==this.plan?this.tasklist.children[t].active=!0:this.tasklist.children[t].active=!1;if(this.title.getComponent(cc.Label).string=this.titlelist[this.plan],this.toolNode=this.tasklist.children[this.plan].getChildByName("tool"),this.tool=this.toolNode.getChildByName("tool"),this.mask=this.tasklist.children[this.plan].getChildByName("mask"),this.rect=this.tasklist.children[this.plan].getChildByName("rect"),this.startpos=this.tool.position,this.tool.getChildByName("icon")&&(this.icon=this.tool.getChildByName("icon"),this.icon.active=!1),4!=this.plan){if(cc.tween(this.toolNode).to(.5,{position:cc.v3(0,0)}).start(),0==this.plan)for(var e=0;e<this.tool.childrenCount;e++){var i=this.tool.children[e];i.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this),i.on(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),i.on(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),i.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)}else this.tool.scale=.8,this.tool.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.on(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.on(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this);if(5==this.plan||6==this.plan){this.cleanpos=[],this.cleamposnum=0;var o=this.tool.children[0].width/4;for(t=0;t<720/o;t++)for(var c=0;c<1280/o;c++){var s=cc.v2(o*t-360,640-o*c),n=this.mask.getComponent(cc.PolygonCollider).points;this.containsPoint(s.x,s.y,n)&&this.cleanpos.push(s)}}7!=this.plan&&8!=this.plan||(this.successnum=5)}else this.Task5Func()},e.prototype.TouchStart=function(t){this.isworking||(this.icon&&(this.icon.active=!0),0==this.plan?(t.target.angle=0,t.target.scale=1.1):this.tool.scale=1,2==this.plan&&(this.tool.angle=0),3==this.plan&&(this.tool.angle=-30),n.default.playEffect("lv501_fang"),this.toolNode.getChildByName("tool_icon")&&(this.toolNode.getChildByName("tool_icon").active=!1))},e.prototype.TouchSMove=function(t){if(!this.isworking){var e=this.node.convertToNodeSpaceAR(t.getLocation());if(0==this.plan?t.target.setPosition(e):(this.tool.x=e.x,this.tool.y=e.y),5==this.plan||6==this.plan){var i=this.mask.children[0],o=cc.rect(i.x,i.y,i.width,i.height),c=cc.v2(e.x+this.tool.children[0].x,e.y+this.tool.children[0].y);this.rectPoint(c,o)&&this.Task6Func()}if(7==this.plan||8==this.plan)for(var s=0;s<this.mask.childrenCount;s++)i=this.mask.children[s],o=cc.rect(i.x,i.y,i.width,i.height),c=cc.v2(e.x+this.tool.children[0].x,e.y+this.tool.children[0].y),this.rectPoint(c,o)&&(i.children[0].active||(i.children[0].active=!0,this.localnum+=1,7==this.plan?(n.default.playEffect("lv501_13_1"),cc.tween(i.children[0]).to(.5,{scale:1}).start()):(n.default.playEffect("lv501_13_1"),cc.tween(i.children[0]).to(.5,{y:0}).start())));this.localnum,this.successnum}},e.prototype.BtnOffClick=function(){if(0==this.plan)for(var t=0;t<this.tool.childrenCount;t++){var e=this.tool.children[t];e.off(cc.Node.EventType.TOUCH_START,this.TouchStart,this),e.off(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),e.off(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),e.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)}else this.tool.off(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.off(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.off(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)},e.prototype.TouchSEnd=function(t){this.isworking||(this.tool.position=this.startpos,0==this.plan?t.target.scale=1:this.tool.scale=.8,2==this.plan&&(this.tool.angle=-105),3==this.plan&&(this.tool.angle=0),7!=this.plan&&8!=this.plan||(console.log("==========1"),this.SuccessFunc()),5!=this.plan&&6!=this.plan||this.cleamposnum>this.cleanpos.length/10*9&&(this.localnum=this.successnum,this.SuccessFunc()),this.rectrect(t.target,this.rect)&&(0==this.plan&&(t.target.active=!1,this.Task1Func()),1==this.plan&&(t.target.active=!1,this.Task2Func()),2==this.plan&&(t.target.active=!1,this.Task3Func()),3==this.plan&&(t.target.active=!1,this.Task4Func()),4==this.plan&&(t.target.active=!1,this.Task5Func())))},e.prototype.Task1Func=function(){var t=this;this.isworking=!0,this.successnum=3;var e=this.mask,i=this.mask.getChildByName("danye");e.active=!0,i.scaleY=0,e.children[1].angle=-20,cc.tween(e.children[0]).to(.2,{angle:-10}).start(),n.default.playEffect("lv501_13_3"),cc.tween(e.children[1]).to(.2,{angle:10}).call(function(){cc.tween(i).to(1,{scaleY:1}).call(function(){i.scaleY=0,e.active=!1,t.rect.children[t.localnum].active=!0,t.localnum++,t.isworking=!1,t.SuccessFunc()}).start()}).start()},e.prototype.Task2Func=function(){var t=this,e=this.rect.getChildByName("action"),i=this.mask.getChildByName("mianfenceng");e.active=!0,e.children[0].active=!0,n.default.playEffect("lv501_13_5"),cc.tween(e).by(.25,{x:50}).by(.5,{x:-100}).by(.25,{x:50}).by(.5,{x:-100}).call(function(){t.scheduleOnce(function(){e.children[0].active=!1,t.successnum=0,cc.tween(e).to(1,{opacity:0}).call(function(){}).start(),t.SuccessFunc()},1)}).start(),cc.tween(i).to(1,{scale:1}).call(function(){e.children[0].active=!1,t.progressBar.node.opacity=0}).start(),this.progressBar.node.opacity=255,this.progressBar.progress=0,cc.tween(this.progressBar).to(1,{progress:1}).start()},e.prototype.Task3Func=function(){var t=this;this.successnum=0;var e=this.rect.parent.getChildByName("action");e.active=!0,n.default.playEffect("lv501_13_2"),cc.tween(e.children[0]).to(.5,{scaleY:1}).call(function(){cc.tween(t.mask.children[0]).to(1,{scaleX:1,scaleY:.9}).call(function(){cc.tween(e).to(1,{opacity:0}).call(function(){}).start(),t.SuccessFunc()}).start()}).start()},e.prototype.Task4Func=function(){var t=this;this.successnum=0;var e=this.rect.parent.getChildByName("action"),i=this.mask.getChildByName("ceng");this.mask.getChildByName("ceng1"),e.active=!0,n.default.playEffect("lv501_13_4"),e.getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.SuccessFunc()},1.5),cc.tween(i).to(.1,{scaleX:.3,scaleY:.3}).to(.9,{scaleX:1,scaleY:1}).call(function(){}).start()},e.prototype.Task5Func=function(){var t=this;this.mask.x=-800,this.successnum=0,this.tool.setPosition(0,-137.788);var e=this.mask.getChildByName("deng"),i=this.mask.getChildByName("kg").children[0];cc.tween(this.tool).to(.5,{position:cc.v3(0,-300)}).call(function(){cc.tween(t.mask).to(.5,{position:cc.v3(0,0)}).call(function(){n.default.playEffect("lv501_13_8")}).delay(.5).call(function(){cc.tween(t.tool).delay(.5).to(1,{scale:.6,position:cc.v3(-40,-40)}).call(function(){t.tool.active=!1,t.mask.getChildByName("tool").active=!0,t.scheduleOnce(function(){t.mask.getChildByName("1").active=!1,t.mask.getChildByName("2").active=!0,t.scheduleOnce(function(){i.active=!0,e.active=!0,e.opacity=0,t.TimerRotation(),n.default.playEffect("lv501_13_7"),cc.tween(t.mask.getChildByName("deng")).to(1.35,{opacity:255}).to(1.35,{opacity:0}).call(function(){i.active=!1,cc.tween(t.mask).delay(1).to(.5,{y:300,opacity:0}).call(function(){t.SuccessFunc()}).start()}).start()},.5)},.5)}).start(),t.mask.getChildByName("1").active=!0,t.mask.getChildByName("2").active=!1}).start()}).start()},e.prototype.SuccessFunc=function(){var t=this;console.log(this.successnum,this.localnum),this.successnum==this.localnum&&(this.BtnOffClick(),this.plan+=1,n.default.playEffect("lv501_good"),this.showbiaoqing(),this.localnum=0,5==this.plan&&this.showSplash(),this.progressBar.node.opacity=0,this.plan==this.tasklist.childrenCount?(this.node_ef_stars.active=!0,cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){t.scheduleOnce(function(){t.GameWin()},1.5)}).start()):cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){t.UpNode()}).start())},e.prototype.NodeAction=function(){var t=this,e=this.mask.parent.getChildByName("pos");if(this.actionNum<6)cc.tween(this.mask.children[this.actionNum]).to(.5,{position:e.children[this.actionNum].position}).call(function(){t.mask.children[t.actionNum].active=!1,t.mask.parent.getChildByName("di").children[t.actionNum].active=!0,t.actionNum+=1,t.NodeAction()}).start();else{cc.tween(this.mask).to(.5,{position:cc.v3(800,0)}).start();var i=this.mask.parent.getChildByName("kaolu"),o=this.mask.parent.getChildByName("di");cc.tween(i).to(.5,{position:cc.v3(800,0)}).call(function(){cc.tween(o).to(.5,{position:cc.v3(0,200)}).call(function(){t.UpNode(),t.successnum=6}).start()}).start()}},e.prototype.Task6Func=function(){var t=this.tool.children[0],e=t.x+this.tool.x,i=t.y+this.tool.y;this._addCircle(cc.v2(e,i),t.width,t.height,this.mask),this.tool.children[0].active=!0;for(var o=0;o<this.cleanpos.length;o++)if(this.cleanpos[o]){var c=this.tool.x+t.x,s=this.tool.y+t.y;if(this.rectToPoints(this.cleanpos[o],cc.v2(c,s),t.width,t.height)){this.cleamposnum+=1,this.cleanpos[o]=null;var a=this.cleamposnum/(this.cleanpos.length/10*9);a>1?this.onRefreshProgressBar(1):(this.isplay||(n.default.playEffect("lv501_13_6"),this.isplay=!1),this.onRefreshProgressBar(a))}}},e.prototype.containsPoint=function(t,e,i){for(var o=i.length,c=0,s=0;s<o;++s){var n=i[s].x,a=i[s].y,l=i[(s+1)%o].x,h=i[(s+1)%o].y;a!=h&&(e<Math.min(a,h)||e>=Math.max(a,h)||(e-a)*(l-n)/(h-a)+n>t&&c++)}return c%2==1},e.prototype.rectToPoints=function(t,e,i,o){return t.x>e.x-i&&t.x<e.x+i&&t.y>e.y-o&&t.y<e.y+o},e.prototype._addCircle=function(t,e,i,o){var c=o.getComponent(cc.Mask)._graphics,s=cc.color(0,0,0,255);c.circle(t.x,t.y,e),c.lineWidth=2,c.fillColor=s,c.fill()},e.prototype.GameWin=function(){var t=this;n.default.playEffect(n.default.audioName.CRRECT),cc.tween(this.dd).to(1,{opacity:255,scale:1}).delay(.5).call(function(){t.dd.scale=0,cc.find("Canvas/game").getComponent(s.default).showResultLayer()}).start()},e.prototype.rectrect=function(t,e,i){void 0===i&&(i=0);var o=cc.rect(-t.width/2,-t.height/2+i,t.width,t.height),c=cc.rect(-e.width/2,-e.height/2+i,e.width,e.height);return!!cc.Intersection.rectRect(c,o)},e.prototype.showbiaoqing=function(){var t=this;this.bq.active=!0,this.bq.scale=0,cc.tween(this.bq).to(.2,{scale:1}).to(.2,{angle:45}).to(.2,{angle:-45}).to(.1,{angle:0}).delay(1).call(function(){t.bq.active=!1}).start()},e.prototype.TimerRotation=function(){this.rect.active=!0,this.rect.getChildByName("zhizhen").angle=140,this.rect.getChildByName("black").getComponent(cc.Sprite).fillRange=0,this.schedule(this.timeradd,.1),this.rect.getChildByName("black").getComponent(cc.Sprite).fillCenter=cc.v2(.5,.5)},e.prototype.timeradd=function(){var t=this.rect.getChildByName("zhizhen"),e=this.rect.getChildByName("black").getComponent(cc.Sprite);if(e.fillRange>=.75)return this.unschedule(this.timeradd),cc.audioEngine.stopAllEffects(),n.default.playEffect("lv501_jsq"),void cc.tween(this.rect).to(.25,{scale:.7}).to(.25,{scale:.6}).call(function(){}).start();this.count++,t.angle-=10,e.fillRange+=.027777777777777776},e.prototype.showSplash=function(){cc.Tween.stopAllByTarget(this.node_splash),this.node_splash.opacity=255,cc.tween(this.node_splash).to(1,{opacity:0},{easing:"fade"}).start()},e.prototype.onRefreshProgressBar=function(t){this.progressBar.progress=t,this.progressBar.node.opacity=255},e.prototype.update=function(){},e.prototype.pointRect=function(t,e){return t.x>=e.x-e.width/2&&t.x<=e.x+e.width/2&&t.y>=e.y-e.height/2&&t.y<=e.y+e.height/2},e.prototype.rectPoint=function(t,e){return t.x>e.x-e.width/2&&t.x<e.x+e.width/2&&t.y<e.y+e.height/2&&t.y>e.y-e.height/2},c([h(cc.Node)],e.prototype,"tasklist",void 0),c([h([cc.String])],e.prototype,"titlelist",void 0),c([h],e.prototype,"isworking",void 0),c([h(cc.Node)],e.prototype,"bq",void 0),c([l],e)}(cc.Component);i.default=r,cc._RF.pop()},{AudioManager:void 0,Game:void 0}],lv501_13_gudie_move:[function(t,e,i){"use strict";cc._RF.push(e,"e71165wFZxOdLoepKAkseD/","lv501_13_gudie_move");var o=__extends,c=__decorate;Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,n=s.ccclass,a=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startPos=cc.v2(0,0),e.endPos=cc.v2(0,0),e.day=0,e}return o(e,t),e.prototype.start=function(){var t=this;this.node.active=!1,this.scheduleOnce(function(){t.node.active=!0,t.node.setPosition(t.startPos);var e=t.endPos.sub(t.startPos).mag()/600;t.node.parent.on(cc.Node.EventType.TOUCH_START,t.close,t),cc.tween(t.node).to(.2,{scale:1}).to(e,{position:cc.v3(t.endPos.x,t.endPos.y)}).to(.2,{scale:1.2}).delay(.2).to(e,{position:cc.v3(t.startPos.x,t.startPos.y)}).union().repeatForever().start()},this.day)},e.prototype.close=function(){this.node.destroy()},c([a(cc.Vec2)],e.prototype,"startPos",void 0),c([a(cc.Vec2)],e.prototype,"endPos",void 0),c([a(cc.Float)],e.prototype,"day",void 0),c([n],e)}(cc.Component);i.default=l,cc._RF.pop()},{}]},{},["lv501_13_Ctrl","lv501_13_gudie_move"]);