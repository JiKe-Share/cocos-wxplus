window.__require=function t(o,i,e){function c(n,a){if(!i[n]){if(!o[n]){var l=n.split("/");if(l=l[l.length-1],!o[l]){var h="function"==typeof __require&&__require;if(!a&&h)return h(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+n+"'")}n=l}var r=i[n]={exports:{}};o[n][0].call(r.exports,function(t){return c(o[n][1][t]||t)},r,r.exports,t,o,i,e)}return i[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<e.length;n++)c(e[n]);return c}({Food_2:[function(t,o,i){"use strict";cc._RF.push(o,"17908kyHeFE6YmTVybSjxMx","Food_2");var e=__extends,c=__decorate;Object.defineProperty(i,"__esModule",{value:!0});var s=t("MathTool"),n=t("Game"),a=t("AudioManager"),l=cc._decorator,h=l.ccclass,r=l.property,d=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.taskNode=null,o.titlelist=[],o.dd=null,o.plan=0,o.successnum=9,o.localnum=0,o.cleanpos=[],o.cleamposnum=0,o}return e(o,t),o.prototype.onLoad=function(){this.dd=this.node.getChildByName("dd"),this.UpNode()},o.prototype.UpNode=function(){for(var t=0;t<this.taskNode.childrenCount;t++)t==this.plan?this.taskNode.children[t].active=!0:this.taskNode.children[t].active=!1;if(this.title=this.taskNode.children[this.plan].getChildByName("title"),this.title.getComponent(cc.Label).string=this.titlelist[this.plan],this.toolNode=this.taskNode.children[this.plan].getChildByName("tool"),this.tool=this.toolNode.getChildByName("tool"),this.mask=this.taskNode.children[this.plan].getChildByName("mask"),this.startpos=this.tool.position,cc.tween(this.toolNode).to(.5,{position:cc.v3(0,0)}).start(),this.tool.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.on(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.on(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this),this.successnum=this.mask.childrenCount,this.localnum=0,4==this.plan){this.cleanpos=[],this.cleamposnum=0;var o=this.tool.children[0].width/4;for(t=0;t<720/o;t++)for(var i=0;i<1280/o;i++){var e=cc.v2(o*t-360,640-o*i),c=this.mask.getComponent(cc.PolygonCollider).points;this.containsPoint(e.x,e.y,c)&&this.cleanpos.push(e)}}},o.prototype.TouchStart=function(){this.toolNode.getChildByName("tool_icon")&&(this.toolNode.getChildByName("tool_icon").active=!1)},o.prototype.TouchSMove=function(t){var o=this.node.convertToNodeSpaceAR(t.getLocation());if(this.tool.x=o.x,this.tool.y=o.y,this.localnum!=this.successnum)if(this.plan>=5)this.Task6Func(o);else{var i=this.mask.children[0],e=cc.rect(i.x,i.y,i.width,i.height),c=cc.v2(o.x+this.tool.children[0].x,o.y+this.tool.children[0].y);s.default.rectPoint(c,e)&&(0==this.plan?this.Task1Func():1==this.plan?this.Task2Func():2==this.plan?this.Task3Func():3==this.plan?this.Task2Func():4==this.plan&&this.Task5Func())}},o.prototype.BtnOffClick=function(){this.tool.off(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.off(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.off(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)},o.prototype.TouchSEnd=function(){this.tool.position=this.startpos,this.SuccessFunc()},o.prototype.SuccessFunc=function(){var t=this;4==this.plan&&this.cleamposnum>this.cleanpos.length/10*9&&(this.localnum=this.successnum),this.successnum==this.localnum&&(this.BtnOffClick(),this.plan+=1,cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){t.plan==t.taskNode.childrenCount?t.GameWin():10==t.plan?t.LastStep():t.UpNode()}).start())},o.prototype.Task1Func=function(){var t=this,o=this.mask.children[0];if(0==o.children[0].opacity){this.toolNode.active=!1;var i=this.taskNode.children[this.plan].getChildByName("action");i.active=!0,cc.tween(i).to(.3,{position:cc.v3(110,325)}).to(.6,{position:cc.v3(80,325)}).to(.3,{position:cc.v3(95,325)}).call(function(){i.active=!1}).start(),cc.tween(o.children[0]).to(1.2,{opacity:255}).call(function(){t.localnum=1,t.successnum=1,t.SuccessFunc()}).start()}},o.prototype.Task2Func=function(){var t=this,o=this.mask.children[0];if(0==o.children[0].scale){this.toolNode.active=!1;var i=this.taskNode.children[this.plan].getChildByName("action");i.active=!0,cc.tween(i).to(1,{angle:360}).call(function(){i.active=!1}).start(),cc.tween(o.children[0]).to(1,{scale:1}).call(function(){t.localnum=1,t.successnum=1,t.SuccessFunc()}).start()}},o.prototype.Task3Func=function(){var t=this,o=this.mask.children[0];if(0==o.children[0].scale){this.toolNode.active=!1;var i=this.taskNode.children[this.plan].getChildByName("action"),e=this.taskNode.children[this.plan].getChildByName("action1");i.active=!0,cc.tween(i).to(1,{position:cc.v3(0,150)}).call(function(){i.active=!1,e.active=!0,cc.tween(o.children[0]).to(1,{scale:1}).call(function(){e.active=!1,t.localnum=1,t.successnum=1,t.SuccessFunc()}).start()}).start()}},o.prototype.Task5Func=function(){var t=this.tool.children[0],o=t.x+this.tool.x,i=t.y+this.tool.y;this._addCircle(cc.v2(o,i),t.width,t.height,this.mask),this.tool.children[0].active=!0;for(var e=0;e<this.cleanpos.length;e++)if(this.cleanpos[e]){var c=this.tool.x+t.x,s=this.tool.y+t.y;this.rectToPoints(this.cleanpos[e],cc.v2(c,s),t.width,t.height)&&(this.cleamposnum+=1,this.cleanpos[e]=null)}},o.prototype.Task6Func=function(t){for(var o=0;o<this.mask.childrenCount;o++){var i=this.mask.children[o],e=cc.rect(i.x,i.y,i.width,i.height),c=cc.v2(t.x+this.tool.children[0].x,t.y+this.tool.children[0].y);s.default.rectPoint(c,e)&&(i.children[0].active||(i.children[0].active=!0,this.localnum+=1,a.default.playEffect("lv2_1_2"),cc.tween(i.children[0]).to(.5,{scale:1}).start()))}},o.prototype.LastStep=function(){for(var t=0;t<this.taskNode.childrenCount;t++)t==this.plan?this.taskNode.children[t].active=!0:this.taskNode.children[t].active=!1;this.localnum=0,this.tool=this.taskNode.children[this.plan].getChildByName("di"),this.title=this.taskNode.children[this.plan].getChildByName("title"),this.title.getComponent(cc.Label).string=this.titlelist[this.plan],this.tool.on(cc.Node.EventType.TOUCH_START,this.GadgetTapBegin,this),this.tool.on(cc.Node.EventType.TOUCH_END,this.ToolTouchEnd,this)},o.prototype.GadgetTapBegin=function(t){var o=t.getLocation();this.startposx=o.x,this.startposx=o.y},o.prototype.ToolTouchEnd=function(t){var o=this,i=t.getLocation();if(this.startposx,i.x,this.startposx-i.y>0)0==this.localnum&&(this.localnum+=1,this.tool.parent.getChildByName("mask").active=!1,this.tool.parent.getChildByName("mask1").active=!0);else if(1==this.localnum){this.localnum+=1,this.tool.parent.getChildByName("mask1").active=!1;var e=this.tool.parent.getChildByName("mask2");e.active=!0,cc.tween(e.children[1]).to(1,{position:cc.v3(80,50)}).call(function(){cc.tween(e).to(.5,{angle:-90,position:cc.v3(-60,0)}).delay(.5).call(function(){o.GameWin()}).start()}).start()}},o.prototype.GameWin=function(){var t=this;a.default.playEffect(a.default.audioName.CRRECT),cc.tween(this.dd).to(1,{opacity:255,scale:1}).delay(.5).call(function(){t.dd.scale=0,cc.find("Canvas/game").getComponent(n.default).showResultLayer()}).start()},o.prototype._addCircle=function(t,o,i,e){var c=e.getComponent(cc.Mask)._graphics,s=cc.color(0,0,0,255);c.circle(t.x,t.y,o),c.lineWidth=2,c.fillColor=s,c.fill()},o.prototype.rectToPoints=function(t,o,i,e){return t.x>o.x-i&&t.x<o.x+i&&t.y>o.y-e&&t.y<o.y+e},o.prototype.containsPoint=function(t,o,i){for(var e=i.length,c=0,s=0;s<e;++s){var n=i[s].x,a=i[s].y,l=i[(s+1)%e].x,h=i[(s+1)%e].y;a!=h&&(o<Math.min(a,h)||o>=Math.max(a,h)||(o-a)*(l-n)/(h-a)+n>t&&c++)}return c%2==1},o.prototype.update=function(){},c([r(cc.Node)],o.prototype,"taskNode",void 0),c([r([cc.String])],o.prototype,"titlelist",void 0),c([h],o)}(cc.Component);i.default=d,cc._RF.pop()},{AudioManager:void 0,Game:void 0,MathTool:void 0}]},{},["Food_2"]);