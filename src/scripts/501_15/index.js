window.__require=function t(e,o,i){function s(n,a){if(!o[n]){if(!e[n]){var l=n.split("/");if(l=l[l.length-1],!e[l]){var h="function"==typeof __require&&__require;if(!a&&h)return h(l,!0);if(c)return c(l,!0);throw new Error("Cannot find module '"+n+"'")}n=l}var r=o[n]={exports:{}};e[n][0].call(r.exports,function(t){return s(e[n][1][t]||t)},r,r.exports,t,e,o,i)}return o[n].exports}for(var c="function"==typeof __require&&__require,n=0;n<i.length;n++)s(i[n]);return s}({lv501_15_Ctrl:[function(t,e,o){"use strict";cc._RF.push(e,"8b983qA/9dEu4350RdNaIe/","lv501_15_Ctrl");var i=__extends,s=__decorate;Object.defineProperty(o,"__esModule",{value:!0});var c=t("MathTool"),n=t("Game"),a=t("AssetManager"),l=t("AudioManager"),h=cc._decorator,r=h.ccclass,p=h.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tasklist=null,e.sccbtn=null,e.titlelist=[],e.dd=null,e.successnum=9,e.localnum=0,e.plan=0,e.cleanpos=[],e.cleamposnum=0,e.progressBar=null,e.node_splash=null,e.node_ef_stars=null,e.sccliz=null,e.isworking=!1,e.isover=!1,e.bq=null,e.isplay=!1,e.count=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.node.opacity=0,a.default.loadSoundEffect_fileDir("AudioClip/lv_501/15",function(){t.node&&(t.node.opacity=255)}),this.dd=this.node.getChildByName("dd"),this.title=this.node.getChildByName("title"),this.progressBar=this.node.getChildByName("progressBar").getComponent(cc.ProgressBar),this.node_ef_stars=this.node.getChildByName("ef_stars"),this.sccliz=this.node.getChildByName("success"),this.node_splash=this.node.getChildByName("splash"),this.UpNode(),cc.sys.isBrowser&&cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){e.keyCode==cc.macro.KEY.space&&(t.plan++,t.UpNode())},this)},e.prototype.UpNode=function(){for(var t=this,e=0;e<this.tasklist.childrenCount;e++)e==this.plan?this.tasklist.children[e].active=!0:this.tasklist.children[e].active=!1;if(this.title.getComponent(cc.Label).string=this.titlelist[this.plan],this.toolNode=this.tasklist.children[this.plan].getChildByName("tool"),this.tool=this.toolNode.getChildByName("tool"),this.action=this.tasklist.children[this.plan].getChildByName("action"),this.mask=this.tasklist.children[this.plan].getChildByName("mask"),this.rect=this.tasklist.children[this.plan].getChildByName("rect"),this.startpos=this.tool.position,3==this.plan||6==this.plan){this.cleanpos=[],this.cleamposnum=0;var o=this.tool.children[0].width/4;for(e=0;e<720/o;e++)for(var i=0;i<1280/o;i++){var s=cc.v2(o*e-360,640-o*i),c=this.mask.getComponent(cc.PolygonCollider).points;this.containsPoint(s.x,s.y,c)&&this.cleanpos.push(s)}}if(7==this.plan)cc.tween(this.mask.children[1]).to(1,{y:0}).call(function(){cc.tween(t.toolNode).to(.5,{position:cc.v3(0,0)}).start(),t.tool.scale=.8,t.action.active=!1,t.tool.on(cc.Node.EventType.TOUCH_START,t.TouchStart,t),t.tool.on(cc.Node.EventType.TOUCH_MOVE,t.TouchSMove,t),t.tool.on(cc.Node.EventType.TOUCH_END,t.TouchSEnd,t),t.tool.on(cc.Node.EventType.TOUCH_CANCEL,t.TouchSEnd,t)}).start(),cc.tween(this.mask.children[0]).to(1,{y:-50}).start(),cc.tween(this.mask.children[2]).to(1,{y:-50}).start();else{if(cc.tween(this.toolNode).to(.5,{position:cc.v3(0,0)}).start(),8==this.plan&&cc.tween(this.mask).to(1,{y:-130}).start(),9==this.plan)return this.successnum=this.tool.childrenCount,this.tool.getComponent(cc.Layout).enabled=!1,void this.sccbtn.on(cc.Node.EventType.TOUCH_END,this.makeover,this);this.tool.scale=.8,this.action.active=!1,this.tool.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.on(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.on(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)}},e.prototype.makeover=function(){this.isover||(this.isover=!0,this.successnum=0,this.localnum=0,this.SuccessFunc(),this.sccbtn.active=!1)},e.prototype.TouchStart=function(t){this.isworking||(t.target.scale=1,l.default.playEffect(l.default.audioName.BUTTON),this.toolNode.getChildByName("tool_icon")&&(this.toolNode.getChildByName("tool_icon").active=!1),3!=this.plan&&6!=this.plan||(this.tool.angle=45))},e.prototype.TouchSMove=function(t){if(!this.isworking){var e=this.node.convertToNodeSpaceAR(t.getLocation());if(2==this.plan||5==this.plan?this.Task2Func():this.tool.setPosition(this.tool.getPosition().add(t.getDelta().mul(.6666666666666666))),3==this.plan||6==this.plan){var o=this.mask.children[0],i=cc.rect(o.x,o.y,o.width,o.height),s=cc.v2(e.x+this.tool.children[0].x,e.y+this.tool.children[0].y);c.default.rectPoint(s,i)&&this.Task3Func()}this.localnum,this.successnum}},e.prototype.BtnOffClick=function(){this.tool.off(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.tool.off(cc.Node.EventType.TOUCH_MOVE,this.TouchSMove,this),this.tool.off(cc.Node.EventType.TOUCH_END,this.TouchSEnd,this),this.tool.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchSEnd,this)},e.prototype.TouchSEnd=function(t){t.target.scale=.8,this.rectrect(t.target,this.rect)&&(8==this.plan&&(t.target.active=!1,this.Mission8Handler()),7==this.plan&&(t.target.active=!1,this.Task7Func()),0!=this.plan&&4!=this.plan||(t.target.active=!1,this.Task1Func()),1==this.plan&&(t.target.active=!1,this.Task0Func())),3!=this.plan&&6!=this.plan||(this.cleamposnum>this.cleanpos.length/10*8?(this.localnum=this.successnum,this.SuccessFunc()):this.tool.angle=0),this.tool.position=this.startpos},e.prototype.Task1Func=function(){var t=this;this.action.active=!0,this.action.getComponent(cc.Animation).play(),this.scheduleOnce(function(){cc.tween(t.mask.children[0]).to(2,{opacity:0}).call(function(){}).start(),t.mask.children[1].active=!0,t.action.active=!1,t.tool.active=!0,t.successnum=0,t.SuccessFunc()},1)},e.prototype.showmask=function(t,e){for(var o=0;o<t.childrenCount;o++)t.children[o].active=o==e},e.prototype.Task0Func=function(){var t=this;this.action.active=!0,this.action.getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.action.active=!1,t.tool.active=!0,cc.tween(t.mask.children[0].children[0]).by(.5,{x:600}).call(function(){t.successnum=0,t.SuccessFunc()}).start(),cc.tween(t.mask.children[0].children[1]).by(.5,{x:600}).call(function(){}).start()},1)},e.prototype.Task2Func=function(){var t=this;this.isworking=!0,this.showmask(this.mask,1),this.scheduleOnce(function(){t.showmask(t.mask,2),t.scheduleOnce(function(){t.successnum=0,t.isworking=!1,t.SuccessFunc()},1)},.5)},e.prototype.playaudio=function(t){cc.audioEngine.stopAllEffects(),l.default.playEffect(t)},e.prototype.Task3Func=function(){var t=this.tool.children[0],e=t.x+this.tool.x,o=t.y+this.tool.y;this._addCircle(cc.v2(e,o),t.width,t.height,this.mask),this.tool.children[0].active=!0;for(var i=0;i<this.cleanpos.length;i++)if(this.cleanpos[i]){var s=this.tool.x+t.x,c=this.tool.y+t.y;if(this.rectToPoints(this.cleanpos[i],cc.v2(s,c),t.width,t.height)){this.cleamposnum+=1,this.cleanpos[i]=null;var n=this.cleamposnum/(this.cleanpos.length/10*9);n>1?this.onRefreshProgressBar(1):(this.isplay||(this.isplay=!1),this.onRefreshProgressBar(n))}}},e.prototype.Task4Func=function(){var t=this,e=this.rect.parent.getChildByName("action").getComponent(cc.Animation);e.node.active=!0,e.play(),this.successnum=0,cc.tween(this.mask.children[0]).to(2,{opacity:255}).delay(1).call(function(){}).start(),this.playaudio("lv501_14_4"),cc.tween(this.rect.children[0]).to(2,{opacity:130}).delay(1).call(function(){t.tool.position=t.startpos,t.SuccessFunc()}).start()},e.prototype.Task5Func=function(){var t=this;this.successnum=0;var e=this.rect.parent.getChildByName("action");e.active=!0,e.scale=1.1,cc.tween(e).to(.5,{scale:1}).call(function(){l.default.playEffect("lv501_fang"),cc.tween(t.mask).to(.5,{opacity:0}).call(function(){t.SuccessFunc()}).start()}).start()},e.prototype.Task6Func=function(){var t=this,e=this.rect.parent.getChildByName("action");e.active=!0,this.successnum=0,this.playaudio("lv501_14_3"),cc.tween(e.children[0]).to(1,{height:0}).call(function(){t.SuccessFunc()}).start(),cc.tween(this.mask).to(1,{opacity:255}).call(function(){}).start()},e.prototype.Task7Func=function(){this.action.active=!0,l.default.playEffect("lv501_fang"),this.successnum=0,this.SuccessFunc()},e.prototype.Mission8Handler=function(){var t=this,e=this.mask.getChildByName("action"),o=this.mask.parent.getComponent(cc.Animation);o.on("finished",this.onFinished,this),e.active=!0,e.x=90,cc.tween(e).to(.5,{x:60}).call(function(){t.scheduleOnce(function(){o.play()},1)}).start(),l.default.playEffect("lv501_fang")},e.prototype.onFinished=function(){var t=this;this.successnum=0,this.scheduleOnce(function(){t.SuccessFunc()},1)},e.prototype.SuccessFunc=function(){var t=this;this.successnum==this.localnum&&(this.BtnOffClick(),this.plan+=1,this.localnum=0,this.progressBar.node.opacity=0,this.plan==this.tasklist.childrenCount?cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){cc.tween(t.mask).by(.3,{y:230}).by(.3,{y:-230}).by(.3,{y:230}).by(.3,{y:-230}).call(function(){t.playaudio("lv501_14_2"),t.scheduleOnce(function(){t.node_ef_stars.active=!0},.5),t.scheduleOnce(function(){t.GameWin()},1.5)}).start()}).start():cc.tween(this.toolNode).to(.5,{position:cc.v3(800,0)}).call(function(){4==t.plan||7==t.plan?(t.showSplash(),t.UpNode()):t.UpNode()}).start())},e.prototype.containsPoint=function(t,e,o){for(var i=o.length,s=0,c=0;c<i;++c){var n=o[c].x,a=o[c].y,l=o[(c+1)%i].x,h=o[(c+1)%i].y;a!=h&&(e<Math.min(a,h)||e>=Math.max(a,h)||(e-a)*(l-n)/(h-a)+n>t&&s++)}return s%2==1},e.prototype.rectToPoints=function(t,e,o,i){return t.x>e.x-o&&t.x<e.x+o&&t.y>e.y-i&&t.y<e.y+i},e.prototype.GameWin=function(){var t=this;l.default.playEffect(l.default.audioName.CRRECT),cc.tween(this.dd).to(1,{opacity:255,scale:1}).delay(.5).call(function(){t.dd.scale=0,cc.find("Canvas/game").getComponent(n.default).showResultLayer()}).start()},e.prototype.rectrect=function(t,e){var o=t.getBoundingBoxToWorld(),i=e.getBoundingBoxToWorld();return!!cc.Intersection.rectRect(i,o)},e.prototype.showbiaoqing=function(t){this.playaudio("lv501_14_6"),t.active=!0,t.scale=0,t.opacity=100,cc.tween(t).to(.5,{scale:1,opacity:255}).delay(.5).to(.2,{scale:1.2,opacity:255}).to(.2,{scale:1,opacity:255}).delay(1).call(function(){t.active=!1}).start()},e.prototype.showSplash=function(){cc.Tween.stopAllByTarget(this.node_splash),this.node_splash.opacity=255,cc.tween(this.node_splash).to(1,{opacity:0},{easing:"fade"}).start()},e.prototype.onRefreshProgressBar=function(t){this.progressBar.progress=t,this.progressBar.node.opacity=255},e.prototype._addCircle=function(t,e,o,i){var s=i.getComponent(cc.Mask)._graphics,c=cc.color(0,0,0,255);s.circle(t.x,t.y,e),s.lineWidth=2,s.fillColor=c,s.fill()},e.prototype.convetOtherNodeSpaceAR=function(t,e){if(!t||!e)return null;var o=t.convertToWorldSpaceAR(cc.v2(0,0));return e.convertToNodeSpaceAR(o)},e.prototype.transformToWorldSpaceAR=function(t,e){return e?e.convertToNodeSpaceAR(t):null},s([p(cc.Node)],e.prototype,"tasklist",void 0),s([p(cc.Node)],e.prototype,"sccbtn",void 0),s([p([cc.String])],e.prototype,"titlelist",void 0),s([p(cc.Node)],e.prototype,"bq",void 0),s([r],e)}(cc.Component);o.default=u,cc._RF.pop()},{AssetManager:void 0,AudioManager:void 0,Game:void 0,MathTool:void 0}],lv_501_15_item:[function(t,e,o){"use strict";cc._RF.push(e,"f588dRKHxNEW5lgYtgvrxpc","lv_501_15_item");var i=__extends,s=__decorate;Object.defineProperty(o,"__esModule",{value:!0});var c=t("AudioManager"),n=t("lv501_15_Ctrl"),a=cc._decorator,l=a.ccclass,h=a.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scriptsParent=null,e.level=null,e.move=!1,e}return i(e,t),e.prototype.onLoad=function(){this.level=this.scriptsParent.getComponent(n.default),this.BtnOnClick()},e.prototype.init=function(t){this.id=t},e.prototype.BtnOnClick=function(){this.startpos=this.node.position,this.node.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.TouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.TouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.TouchEnd,this)},e.prototype.BtnOffClick=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.TouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.TouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.TouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.TouchEnd,this)},e.prototype.TouchStart=function(){this.node.scale=1.1,c.default.playEffect(c.default.audioName.BUTTON)},e.prototype.TouchMove=function(t){this.node.position=this.node.parent.convertToNodeSpaceAR(t.getLocation())},e.prototype.additem=function(){c.default.playEffect("lv501_fang"),this.level.localnum++;var t=this.convetOtherNodeSpaceAR(this.node,this.level.mask);if(this.node.parent=this.level.mask,this.node.position=t,this.level.sccbtn.active=!0,this.BtnOffClick(),this.level.localnum>=this.level.successnum){if(this.level.isover)return;this.level.sccbtn.active=!1,this.level.isover=!0,this.level.SuccessFunc()}},e.prototype.convetOtherNodeSpaceAR=function(t,e){if(!t||!e)return null;var o=t.convertToWorldSpaceAR(cc.v2(0,0));return e.convertToNodeSpaceAR(o)},e.prototype.TouchEnd=function(){this.isrect2()},e.prototype.isrect2=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.level.rect.getBoundingBoxToWorld().contains(t)?this.additem():(this.node.position=this.startpos,this.move=!1,this.node.scale=1)},s([h(cc.Node)],e.prototype,"scriptsParent",void 0),s([l],e)}(cc.Component);o.default=r,cc._RF.pop()},{AudioManager:void 0,lv501_15_Ctrl:"lv501_15_Ctrl"}]},{},["lv501_15_Ctrl","lv_501_15_item"]);